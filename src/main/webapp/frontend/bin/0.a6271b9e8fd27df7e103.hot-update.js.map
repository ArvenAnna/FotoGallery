{"version":3,"sources":["webpack:///./components/editAlbum/EditCanvas.jsx","webpack:///./components/editAlbum/ImageRotater.jsx"],"names":["routesModule","require","EditCanvas","React","Component","constructor","props","state","angle","width","parseInt","height","imageLoading","getEditedImage","album","image","avatar","getImage","toBlob","img","name","split","length","file","File","http","sendFile","routes","UPLOAD_FOTO","then","downloadedFoto","doPost","FOTO_ROUTE","src","_id","result","newPictures","images","push","newAlbum","Object","assign","cleanImage","imageDownloaded","rotateImage","newAngle","calculateParameters","newState","naturalWidth","naturalHeight","setState","onLoad","imgInfo","onImageFailure","closeImage","render","ae","isFileAPISupported","AvatarEditor","setCanvas","canvas","isVertical","rotate","isDataURL","str","regex","match","loadImage","loadImageFile","loadImageURL","imageURL","imageObj","Image","onload","handleImageReady","bind","onerror","onLoadFailure","crossOrigin","imageFile","reader","FileReader","e","target","readAsDataURL","componentDidMount","componentDidUpdate","ReactDOM","findDOMNode","context","getContext","clearRect","paintImage","onImageReady","onLoadSuccess","componentWillReceiveProps","newProps","save","translate","Math","PI","scale","globalCompositeOperation","drawImage","restore","document","createElement","defaultStyle","cursor","attributes","style","propTypes","PropTypes","number","oneOfType","string","instanceOf","object","oneOf","func","loading","bool","defaultProps"],"mappings":";;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA,MAAMA,eAAe,mBAAAC,CAAQ,EAAR,CAArB;AACA;;IAEMC,U,GAAN,MAAMA,UAAN,SAAyB,6CAAAC,CAAMC,SAA/B,CAAyC;;AAErCC,gBAAYC,KAAZ,EAAmB;AACf,cAAMA,KAAN;AACA,aAAKC,KAAL,GAAa;AACTC,mBAAO,CADE;AAETC,mBAAOC,SAAS,qEAAT,CAFE;AAGTC,oBAAQD,SAAS,sEAAT,CAHC;AAITE,0BAAc;AAJL,SAAb;AAMH;;AAEDC,qBAAiB;AACb,cAAM,EAACC,KAAD,EAAQC,KAAR,KAAiB,KAAKT,KAA5B;AACA,aAAKU,MAAL,CAAYC,QAAZ,GAAuBC,MAAvB,CAA8BC,OAAO;AACjC,gBAAIC,OAAOL,MAAMM,KAAN,CAAY,GAAZ,CAAX;AACAD,mBAAOA,KAAKA,KAAKE,MAAL,GAAc,CAAnB,CAAP;AACA,kBAAMC,OAAO,IAAIC,IAAJ,CAAS,CAACL,GAAD,CAAT,EAAgBC,IAAhB,CAAb;;AAEAK,YAAA,6DAAAA,CAAKC,QAAL,CAAc1B,aAAa2B,MAAb,CAAoBC,WAAlC,EAA+CL,IAA/C,EACKM,IADL,CACUC,kBAAkB;AACpBL,gBAAA,6DAAAA,CAAKM,MAAL,CAAY/B,aAAa2B,MAAb,CAAoBK,UAAhC,EAA4C;AACxCC,yBAAKH,eAAeG,GADoB;AAExCnB,2BAAOA,MAAMoB;AAF2B,iBAA5C,EAGGL,IAHH,CAGQM,UAAU;AACV,0BAAMC,cAAc,CAAC,GAAGtB,MAAMuB,MAAV,CAApB;AACAD,gCAAYE,IAAZ,CAAiBH,MAAjB;AACA,0BAAMI,WAAWC,OAAOC,MAAP,CAAc,EAAd,eACV3B,KADU;AAEbuB,gCAAQD;AAFK,uBAAjB;;AAKA,yBAAK9B,KAAL,CAAWoC,UAAX,CAAsB;AAClBC,yCAAiB,IADC;AAElB7B,+BAAOyB;AAFW,qBAAtB;AAIH,iBAfL;AAgBH,aAlBL;AAmBH,SAxBD;AAyBH;;AAEDK,kBAAc;AACV,cAAMC,WAAW,KAAKtC,KAAL,CAAWC,KAAX,GAAmB,EAApC;AACA,aAAKsC,mBAAL,CAAyBD,QAAzB;AACH;;AAEDC,wBAAoBD,QAApB,EAA8B;AAC1B,cAAME,WAAW;AACbpC,oBAAQD,SAAS,sEAAT,CADK;AAEbF,mBAAQqC;AAFK,SAAjB;AAIAE,iBAAStC,KAAT,GAAiBoC,WAAW,GAAX,IAAkB,CAAlB,GACXnC,SAAS,KAAKsC,YAAL,GAAoB,KAAKzC,KAAL,CAAWI,MAA/B,GAAwC,KAAKsC,aAAtD,CADW,GAEXvC,SAAS,KAAKuC,aAAL,GAAqB,KAAK1C,KAAL,CAAWI,MAAhC,GAAyC,KAAKqC,YAAvD,CAFN;AAGA,aAAKE,QAAL,CAAcH,QAAd;AACH;;AAEDI,WAAOC,OAAP,EAAgB;AACZ,aAAKF,QAAL,CAAc,EAACtC,cAAc,KAAf,EAAd;AACA,aAAKoC,YAAL,GAAoBI,QAAQJ,YAA5B;AACA,aAAKC,aAAL,GAAqBG,QAAQH,aAA7B;;AAEA,aAAKH,mBAAL,CAAyB,KAAKvC,KAAL,CAAWC,KAApC;AACH;;AAED6C,qBAAiB;AACb,aAAKH,QAAL,CAAc,EAACtC,cAAc,KAAf,EAAd;AACH;;AAED0C,iBAAa;AACT,aAAKhD,KAAL,CAAWoC,UAAX,CAAsB,EAACC,iBAAiB,KAAlB,EAAtB;AACH;;AAEDY,aAAS;AACL,cAAM,EAACxC,KAAD,KAAU,KAAKT,KAArB;AACA,cAAM,EAACE,KAAD,EAAQC,KAAR,EAAeE,MAAf,EAAuBC,YAAvB,KAAuC,KAAKL,KAAlD;AACA,eAAO;AAAA;AAAA,cAAK,WAAU,aAAf;AACH,wEAAC,8DAAD;AACI,qBAAKiD,MAAM,KAAKxC,MAAL,GAAcwC,EAD7B;AAEI,uBAAOzC,KAFX;AAGI,wBAAQP,KAHZ;AAII,uBAAOC,KAJX;AAKI,wBAAQE,MALZ;AAMI,+BAAgByC,OAAD,IAAa,KAAKD,MAAL,CAAYC,OAAZ,CANhC;AAOI,+BAAe,MAAM,KAAKC,cAAL,EAPzB;AAQI,yBAASzC;AARb,cADG;AAWH,wEAAC,0DAAD,IAAY,WAAU,aAAtB,EAAoC,SAAS,MAAM,KAAKgC,WAAL,EAAnD,GAXG;AAYH,wEAAC,wDAAD,IAAU,WAAU,WAApB,EAAgC,SAAS,MAAM,KAAK/B,cAAL,EAA/C,GAZG;AAaH,wEAAC,yDAAD,IAAW,WAAU,YAArB,EAAkC,SAAS,MAAM,KAAKyC,UAAL,EAAjD;AAbG,SAAP;AAeH;AA3FoC,C;;;AA8FzC,yDAAepD,UAAf,E;;;;;;;;;;;;;;;;;;ACtGA;AACA;AACA;;AAEA,MAAMuD,qBAAqB,OAAOjC,IAAP,KAAgB,WAA3C;;IAEMkC,Y,sBAAN,MAAMA,YAAN,SAA2B,6CAAAvD,CAAMC,SAAjC,CAA2C;AAAA;AAAA;;AAAA,4CA4BvCG,KA5BuC,GA4B/B;AACJQ,mBAAO;AADH,SA5B+B,OAoIvC4C,SApIuC,GAoI1BC,MAAD,IAAY;AACpB,iBAAKA,MAAL,GAAcA,MAAd;AACH,SAtIsC;AAAA;;AAgCvCC,iBAAc;AACV,eAAO,KAAKvD,KAAL,CAAWwD,MAAX,GAAoB,GAApB,KAA4B,CAAnC;AACH;;AAEDC,cAAWC,GAAX,EAAgB;AACZ,YAAIA,QAAQ,IAAZ,EAAkB;AACd,mBAAO,KAAP;AACH;AACD,cAAMC,QAAQ,+FAAd;AACA,eAAO,CAAC,CAACD,IAAIE,KAAJ,CAAUD,KAAV,CAAT;AACH;;AAEDE,cAAWpD,KAAX,EAAkB;AACd,YAAI0C,sBAAsB1C,iBAAiBS,IAA3C,EAAiD;AAC7C,iBAAK4C,aAAL,CAAmBrD,KAAnB;AACH,SAFD,MAEO,IAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;AAClC,iBAAKsD,YAAL,CAAkBtD,KAAlB;AACH;AACJ;;AAEDsD,iBAAcC,QAAd,EAAwB;AACpB,cAAMC,WAAW,IAAIC,KAAJ,EAAjB;AACAD,iBAASE,MAAT,GAAkB,KAAKC,gBAAL,CAAsBC,IAAtB,CAA2B,IAA3B,EAAiCJ,QAAjC,CAAlB;AACAA,iBAASK,OAAT,GAAmB,KAAKtE,KAAL,CAAWuE,aAA9B;AACA,YAAI,CAAC,KAAKd,SAAL,CAAeO,QAAf,CAAD,IAA6B,KAAKhE,KAAL,CAAWwE,WAA5C,EAAyD;AAAEP,qBAASO,WAAT,GAAuB,KAAKxE,KAAL,CAAWwE,WAAlC;AAA+C;AAC1GP,iBAAStC,GAAT,GAAeqC,QAAf;AACH;;AAEDF,kBAAeW,SAAf,EAA0B;AACtB,cAAMC,SAAS,IAAIC,UAAJ,EAAf;AACAD,eAAOP,MAAP,GAAgBS,KAAK,KAAKb,YAAL,CAAkBa,EAAEC,MAAF,CAAShD,MAA3B,CAArB;AACA6C,eAAOI,aAAP,CAAqBL,SAArB;AACH;;AAEDM,wBAAqB;AACjB,YAAI,KAAK/E,KAAL,CAAWS,KAAf,EAAsB;AAClB,iBAAKoD,SAAL,CAAe,KAAK7D,KAAL,CAAWS,KAA1B;AACH;AACJ;;AAEDuE,yBAAsB;AAClB,cAAM1B,SAAS,iDAAA2B,CAASC,WAAT,CAAqB,KAAK5B,MAA1B,CAAf;AACA,cAAM6B,UAAU7B,OAAO8B,UAAP,CAAkB,IAAlB,CAAhB;AACAD,gBAAQE,SAAR,CAAkB,CAAlB,EAAqB,CAArB,EAAwB/B,OAAOnD,KAA/B,EAAsCmD,OAAOjD,MAA7C;AACA,aAAKiF,UAAL,CAAgBH,OAAhB,EAAyB,KAAKlF,KAAL,CAAWQ,KAApC;AACH;;AAED2D,qBAAkB3D,KAAlB,EAAyB;AACrB,aAAKmC,QAAL,CAAc,EAAEnC,KAAF,EAAd,EAAyB,KAAKT,KAAL,CAAWuF,YAApC;AACA,aAAKvF,KAAL,CAAWwF,aAAX,CAAyB/E,KAAzB;AACH;;AAEDgF,8BAA2BC,QAA3B,EAAqC;AACjC,YACKA,SAASjF,KAAT,IAAkB,KAAKT,KAAL,CAAWS,KAAX,KAAqBiF,SAASjF,KAAjD,IACA,KAAKT,KAAL,CAAWG,KAAX,KAAqBuF,SAASvF,KAD9B,IAEA,KAAKH,KAAL,CAAWK,MAAX,KAAsBqF,SAASrF,MAHnC,EAIE;AACE,iBAAKwD,SAAL,CAAe6B,SAASjF,KAAxB;AACH;AACJ;;AAED6E,eAAYH,OAAZ,EAAqB1E,KAArB,EAA4B;AACxB,YAAIA,KAAJ,EAAW;;AAEP0E,oBAAQQ,IAAR;;AAEAR,oBAAQS,SAAR,CAAkBT,QAAQ7B,MAAR,CAAenD,KAAf,GAAuB,CAAzC,EAA4CgF,QAAQ7B,MAAR,CAAejD,MAAf,GAAwB,CAApE;AACA8E,oBAAQ3B,MAAR,CAAe,KAAKxD,KAAL,CAAWwD,MAAX,GAAoBqC,KAAKC,EAAzB,GAA8B,GAA7C;AACAX,oBAAQS,SAAR,CACI,EAAET,QAAQ7B,MAAR,CAAenD,KAAf,GAAuB,CAAzB,CADJ,EAEI,EAAEgF,QAAQ7B,MAAR,CAAejD,MAAf,GAAwB,CAA1B,CAFJ;;AAKA,gBAAI,KAAKkD,UAAL,EAAJ,EAAuB;AACnB4B,wBAAQS,SAAR,CACI,CAACT,QAAQ7B,MAAR,CAAenD,KAAf,GAAuBgF,QAAQ7B,MAAR,CAAejD,MAAvC,IAAiD,CADrD,EAEI,CAAC8E,QAAQ7B,MAAR,CAAejD,MAAf,GAAwB8E,QAAQ7B,MAAR,CAAenD,KAAxC,IAAiD,CAFrD;AAIH;;AAEDgF,oBAAQY,KAAR,CAAc,CAAd,EAAiB,CAAjB;;AAEAZ,oBAAQa,wBAAR,GAAmC,kBAAnC;;AAEA,gBAAG,KAAKzC,UAAL,EAAH,EAAsB;AAClB4B,wBAAQc,SAAR,CACIxF,KADJ,EAEI,CAFJ,EAEO,CAFP,EAEU,KAAKT,KAAL,CAAWK,MAFrB,EAE6B,KAAKL,KAAL,CAAWG,KAFxC;AAIH;AACDgF,oBAAQc,SAAR,CACIxF,KADJ,EAEI,CAFJ,EAEO,CAFP,EAEU,KAAKT,KAAL,CAAWG,KAFrB,EAE4B,KAAKH,KAAL,CAAWK,MAFvC;;AAKA8E,oBAAQe,OAAR;AACH;AACJ;;AAMDvF,eAAY;AACR,cAAMF,QAAQ,KAAKR,KAAL,CAAWQ,KAAzB;;AAEA;AACA,cAAM6C,SAAS6C,SAASC,aAAT,CAAuB,QAAvB,CAAf;;AAEA,YAAI,KAAK7C,UAAL,EAAJ,EAAuB;AACnBD,mBAAOnD,KAAP,GAAeM,MAAMJ,MAArB;AACAiD,mBAAOjD,MAAP,GAAgBI,MAAMN,KAAtB;AACH,SAHD,MAGO;AACHmD,mBAAOnD,KAAP,GAAeM,MAAMN,KAArB;AACAmD,mBAAOjD,MAAP,GAAgBI,MAAMJ,MAAtB;AACH;;AAED;AACA;AACA,cAAM8E,UAAU7B,OAAO8B,UAAP,CAAkB,IAAlB,CAAhB;;AAEAD,gBAAQS,SAAR,CAAkBtC,OAAOnD,KAAP,GAAe,CAAjC,EAAoCmD,OAAOjD,MAAP,GAAgB,CAApD;AACA8E,gBAAQ3B,MAAR,CAAe,KAAKxD,KAAL,CAAWwD,MAAX,GAAoBqC,KAAKC,EAAzB,GAA8B,GAA7C;AACAX,gBAAQS,SAAR,CAAkB,EAAEtC,OAAOnD,KAAP,GAAe,CAAjB,CAAlB,EAAuC,EAAEmD,OAAOjD,MAAP,GAAgB,CAAlB,CAAvC;;AAEA,YAAI,KAAKkD,UAAL,EAAJ,EAAuB;AACnB4B,oBAAQS,SAAR,CACI,CAACtC,OAAOnD,KAAP,GAAemD,OAAOjD,MAAvB,IAAiC,CADrC,EAEI,CAACiD,OAAOjD,MAAP,GAAgBiD,OAAOnD,KAAxB,IAAiC,CAFrC;AAIH;;AAEDgF,gBAAQc,SAAR,CAAkBxF,KAAlB,EAAyB,CAAzB,EAA4B,CAA5B;;AAEA,eAAO6C,MAAP;AACH;;AAEDL,aAAU;AACN;AACA;AACA;;AAEA,cAAMoD,eAAe;AACjBlG,mBAAO,KAAKH,KAAL,CAAWG,KADD;AAEjBE,oBAAQ,KAAKL,KAAL,CAAWK,MAFF;AAGjBiG,oBAAQ;AAHS,SAArB;;AAMA,cAAMC,aAAa;AACfpG,mBAAO,KAAKH,KAAL,CAAWG,KADH;AAEfE,oBAAQ,KAAKL,KAAL,CAAWK,MAFJ;AAGfmG,gCACOH,YADP,EAEO,KAAKrG,KAAL,CAAWwG,KAFlB;AAHe,SAAnB;;AASA,eAAO,iFAAQ,KAAK,KAAKnD,SAAlB,IAAiCkD,UAAjC,EAAP;AACH;AA/LsC,C,SAChCE,S,GAAY;AACfjD,YAAQ,kDAAAkD,CAAUC,MADH;AAEflG,WAAO,kDAAAiG,CAAUE,SAAV,CAAoB,CACvB,kDAAAF,CAAUG,MADa,EAEvB,IAAI1D,qBAAqB,CAAC,kDAAAuD,CAAUI,UAAV,CAAqB5F,IAArB,CAAD,CAArB,GAAoD,EAAxD,CAFuB,CAApB,CAFQ;AAMff,WAAO,kDAAAuG,CAAUC,MANF;AAOftG,YAAQ,kDAAAqG,CAAUC,MAPH;AAQfH,WAAO,kDAAAE,CAAUK,MARF;AASfvC,iBAAa,kDAAAkC,CAAUM,KAAV,CAAgB,CAAC,EAAD,EAAK,WAAL,EAAkB,iBAAlB,CAAhB,CATE;;AAWfzC,mBAAe,kDAAAmC,CAAUO,IAXV;AAYfzB,mBAAe,kDAAAkB,CAAUO,IAZV;AAaf1B,kBAAc,kDAAAmB,CAAUO,IAbT;AAcfC,aAAS,kDAAAR,CAAUS;AAdJ,C,SAiBZC,Y,GAAe;AAClB5D,YAAQ,CADU;AAElBrD,WAAO,GAFW;AAGlBE,YAAQ,GAHU;AAIlBmG,WAAO,EAJW;AAKlBjC,oBAAiB,CAAE,CALD;AAMlBiB,oBAAiB,CAAE,CAND;AAOlBD,mBAAgB,CAAE;AAPA,C;;;AAgL1B,yDAAenC,YAAf,E","file":"0.a6271b9e8fd27df7e103.hot-update.js","sourcesContent":["import React from 'react';\nimport './editCanvas.less';\nimport {CrossIcon, RotateIcon, SaveIcon} from \"../Icons\";\nimport AvatarEditor from \"./ImageRotater\";\nimport * as styles from \"../../constants/styles\";\nconst routesModule = require('../../constants/routes');\nimport http from '../../HttpService';\n\nclass EditCanvas extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            angle: 0,\n            width: parseInt(styles.picture_edit_width),\n            height: parseInt(styles.picture_edit_height),\n            imageLoading: true\n        }\n    }\n\n    getEditedImage() {\n        const {album, image} = this.props;\n        this.avatar.getImage().toBlob(img => {\n            let name = image.split('/');\n            name = name[name.length - 1];\n            const file = new File([img], name);\n\n            http.sendFile(routesModule.routes.UPLOAD_FOTO, file)\n                .then(downloadedFoto => {\n                    http.doPost(routesModule.routes.FOTO_ROUTE, {\n                        src: downloadedFoto.src,\n                        album: album._id\n                    }).then(result => {\n                            const newPictures = [...album.images];\n                            newPictures.push(result);\n                            const newAlbum = Object.assign({}, {\n                                ...album,\n                                images: newPictures,\n                            });\n\n                            this.props.cleanImage({\n                                imageDownloaded: null,\n                                album: newAlbum\n                            });\n                        });\n                });\n        });\n    }\n\n    rotateImage() {\n        const newAngle = this.state.angle + 90;\n        this.calculateParameters(newAngle);\n    }\n\n    calculateParameters(newAngle) {\n        const newState = {\n            height: parseInt(styles.picture_edit_height),\n            angle : newAngle\n        };\n        newState.width = newAngle % 180 == 0\n            ? parseInt(this.naturalWidth * this.state.height / this.naturalHeight)\n            : parseInt(this.naturalHeight * this.state.height / this.naturalWidth);\n        this.setState(newState);\n    }\n\n    onLoad(imgInfo) {\n        this.setState({imageLoading: false});\n        this.naturalWidth = imgInfo.naturalWidth;\n        this.naturalHeight = imgInfo.naturalHeight;\n\n        this.calculateParameters(this.state.angle);\n    }\n\n    onImageFailure() {\n        this.setState({imageLoading: false});\n    }\n\n    closeImage() {\n        this.props.cleanImage({imageDownloaded: false});\n    }\n\n    render() {\n        const {image} = this.props;\n        const {angle, width, height, imageLoading} = this.state;\n        return <div className=\"Edit_canvas\">\n            <AvatarEditor\n                ref={ae => this.avatar = ae}\n                image={image}\n                rotate={angle}\n                width={width}\n                height={height}\n                onLoadSuccess={(imgInfo) => this.onLoad(imgInfo)}\n                onLoadFailure={() => this.onImageFailure()}\n                loading={imageLoading}\n            />\n            <RotateIcon className='rotate_icon' onClick={() => this.rotateImage()}/>\n            <SaveIcon className='save_icon' onClick={() => this.getEditedImage()}/>\n            <CrossIcon className='cross_icon' onClick={() => this.closeImage()}/>\n        </div>\n    }\n}\n\nexport default EditCanvas;\n\n\n\n// WEBPACK FOOTER //\n// ./components/editAlbum/EditCanvas.jsx","import PropTypes from 'prop-types';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nconst isFileAPISupported = typeof File !== 'undefined'\n\nclass AvatarEditor extends React.Component {\n    static propTypes = {\n        rotate: PropTypes.number,\n        image: PropTypes.oneOfType([\n            PropTypes.string,\n            ...(isFileAPISupported ? [PropTypes.instanceOf(File)] : [])\n        ]),\n        width: PropTypes.number,\n        height: PropTypes.number,\n        style: PropTypes.object,\n        crossOrigin: PropTypes.oneOf(['', 'anonymous', 'use-credentials']),\n\n        onLoadFailure: PropTypes.func,\n        onLoadSuccess: PropTypes.func,\n        onImageReady: PropTypes.func,\n        loading: PropTypes.bool\n    }\n\n    static defaultProps = {\n        rotate: 0,\n        width: 300,\n        height: 200,\n        style: {},\n        onLoadFailure () {},\n        onLoadSuccess () {},\n        onImageReady () {}\n    }\n\n    state = {\n        image: null\n    }\n\n    isVertical () {\n        return this.props.rotate % 180 !== 0\n    }\n\n    isDataURL (str) {\n        if (str === null) {\n            return false\n        }\n        const regex = /^\\s*data:([a-z]+\\/[a-z]+(;[a-z-]+=[a-z-]+)?)?(;base64)?,[a-z0-9!$&',()*+;=\\-._~:@/?%\\s]*\\s*$/i\n        return !!str.match(regex)\n    }\n\n    loadImage (image) {\n        if (isFileAPISupported && image instanceof File) {\n            this.loadImageFile(image)\n        } else if (typeof image === 'string') {\n            this.loadImageURL(image)\n        }\n    }\n\n    loadImageURL (imageURL) {\n        const imageObj = new Image()\n        imageObj.onload = this.handleImageReady.bind(this, imageObj)\n        imageObj.onerror = this.props.onLoadFailure\n        if (!this.isDataURL(imageURL) && this.props.crossOrigin) { imageObj.crossOrigin = this.props.crossOrigin }\n        imageObj.src = imageURL\n    }\n\n    loadImageFile (imageFile) {\n        const reader = new FileReader()\n        reader.onload = e => this.loadImageURL(e.target.result)\n        reader.readAsDataURL(imageFile)\n    }\n\n    componentDidMount () {\n        if (this.props.image) {\n            this.loadImage(this.props.image)\n        }\n    }\n\n    componentDidUpdate () {\n        const canvas = ReactDOM.findDOMNode(this.canvas)\n        const context = canvas.getContext('2d')\n        context.clearRect(0, 0, canvas.width, canvas.height)\n        this.paintImage(context, this.state.image);\n    }\n\n    handleImageReady (image) {\n        this.setState({ image }, this.props.onImageReady)\n        this.props.onLoadSuccess(image)\n    }\n\n    componentWillReceiveProps (newProps) {\n        if (\n            (newProps.image && this.props.image !== newProps.image) ||\n            this.props.width !== newProps.width ||\n            this.props.height !== newProps.height\n        ) {\n            this.loadImage(newProps.image)\n        }\n    }\n\n    paintImage (context, image) {\n        if (image) {\n\n            context.save()\n\n            context.translate(context.canvas.width / 2, context.canvas.height / 2)\n            context.rotate(this.props.rotate * Math.PI / 180)\n            context.translate(\n                -(context.canvas.width / 2),\n                -(context.canvas.height / 2)\n            )\n\n            if (this.isVertical()) {\n                context.translate(\n                    (context.canvas.width - context.canvas.height) / 2,\n                    (context.canvas.height - context.canvas.width) / 2\n                )\n            }\n\n            context.scale(1, 1)\n\n            context.globalCompositeOperation = 'destination-over';\n\n            if(this.isVertical()) {\n                context.drawImage(\n                    image,\n                    0, 0, this.props.height, this.props.width\n                )\n            }\n            context.drawImage(\n                image,\n                0, 0, this.props.width, this.props.height\n            )\n\n            context.restore()\n        }\n    }\n\n    setCanvas = (canvas) => {\n        this.canvas = canvas\n    }\n\n    getImage () {\n        const image = this.state.image;\n\n        // create a canvas with the correct dimensions\n        const canvas = document.createElement('canvas')\n\n        if (this.isVertical()) {\n            canvas.width = image.height;\n            canvas.height = image.width;\n        } else {\n            canvas.width = image.width;\n            canvas.height = image.height\n        }\n\n        // draw the full-size image at the correct position,\n        // the image gets truncated to the size of the canvas.\n        const context = canvas.getContext('2d')\n\n        context.translate(canvas.width / 2, canvas.height / 2)\n        context.rotate(this.props.rotate * Math.PI / 180)\n        context.translate(-(canvas.width / 2), -(canvas.height / 2))\n\n        if (this.isVertical()) {\n            context.translate(\n                (canvas.width - canvas.height) / 2,\n                (canvas.height - canvas.width) / 2\n            )\n        }\n\n        context.drawImage(image, 0, 0)\n\n        return canvas\n    }\n\n    render () {\n        // if(!this.state.image) {\n        //     return null;\n        // }\n\n        const defaultStyle = {\n            width: this.props.width,\n            height: this.props.height,\n            cursor: 'grab'\n        }\n\n        const attributes = {\n            width: this.props.width,\n            height: this.props.height,\n            style: {\n                ...defaultStyle,\n                ...this.props.style\n            }\n        }\n\n        return <canvas ref={this.setCanvas} {...attributes} />\n    }\n}\n\nexport default AvatarEditor\n\n\n\n// WEBPACK FOOTER //\n// ./components/editAlbum/ImageRotater.jsx"],"sourceRoot":""}