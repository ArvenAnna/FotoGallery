{"version":3,"sources":["webpack:///./constants/styles.js","webpack:///./components/picture/Picture.jsx","webpack:///./components/picture/Preview.jsx","webpack:///./components/picture/PreviewImageFrame.jsx","webpack:///./components/editAlbum/EditAlbum.jsx","webpack:///./components/editAlbum/Card.jsx","webpack:///./components/editAlbum/EditCanvas.jsx"],"names":["constants","module","exports","Picture","React","Component","constructor","props","imageLoadStarted","state","magnify","valid","loading","click","setState","animation","closePreview","mouseLeave","e","chooseAnimation","mouseEnter","fade","move","findSide","direction","clientRect","target","getClientRects","diffs","side","diff","Math","abs","clientX","left","right","clientY","top","bottom","minDiff","min","Array","from","el","find","handleBrokenImg","onLoad","loadImage","url","image","Image","onload","bind","onerror","src","render","album","main","images","isVideo","name","_id","BottomSection","styled","div","imageWidth","increase","preview_frame_color","decrease","Modal","animationTime","Preview","parseInt","animate","currentSlide","setImageWidth","width","clearAnimate","slide","close","clearAnimation","calculateTextWidth","imgWidth","bottomSection","document","getElementsByClassName","style","currentStyle","window","getComputedStyle","paddings","parseFloat","paddingLeft","paddingRight","calculateTextHeight","caption","bottomSectionStyle","paddingTop","paddingBottom","captionStyle","height","editRoute","s","r","text","PreviewImageFrame","img","current","currentIndex","indexOf","length","index","componentDidMount","getContainerHeight","addEventListener","recalculateWidth","cont","containerStyle","componentWillUnmount","removeEventListener","naturalWidth","naturalHeight","preview_border_width","innerWidth","newImages","loaded","onCrossClick","onArrowClick","arrow","loadImageURL","imageURL","imageObj","onLoadFailure","node","routesModule","require","EditAlbum","connect","store","deleteFotoFromAlbum","saveFotoDescription","saveAlbumDescription","deleteAlbum","saveItemsOrder","dragStarted","dragFrom","dragFromEl","dragObj","openPicture","openedAlbum","openedDialog","imageDownloaded","imageLoading","albumLoading","loadAlbum","http","doGet","routes","GET_ALBUM","match","params","id","then","result","sort","x","y","order","forEach","Date","toISOString","openDetails","picture","openAlbumDetails","deleteItem","newPictures","filter","p","newAlbum","Object","assign","removeAlbum","history","push","changeState","obj","editedPicture","pinput","value","ptextarea","editedAlbum","ainput","atextarea","description","uploadFile","file","sendFile","UPLOAD_FOTO","downloadedFoto","doPost","FOTO_ROUTE","onImageLoad","onImageError","renderEditAlbumCard","renderImages","map","replaceImage","renderFileInput","renderEditCanvas","renderChangeFotoTextInfoDialog","i","t","renderChangeAlbumTextInfoDialog","renderDeleteDialog","Card","replaceEvent","componentWillReceiveProps","dragContainer","replaceAttached","body","onUpBody","elementAtPoint","elementFromPoint","scrollX","scrollY","parentElement","classList","contains","changeDragState","attr","getAttribute","pictures","changePictureAndClear","onMouseDown","preventDefault","elStartLeft","elStartTop","zIndex","onMouseMove","dragState","onMouseUp","event","Event","dispatchEvent","dragToPicture","dragFromPicture","prevOrder","updateOrder","EditCanvas","angle","getEditedImage","avatar","getImage","toBlob","split","File","cleanImage","rotateImage","newAngle","calculateParameters","newState","imgInfo","onImageFailure","closeImage","ae"],"mappings":"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","file":"0.c70ff842d12c08d65949.hot-update.js","sourcesContent":["const constants = {\n    'preview_animation_duration': '2s',\n    'picture_animation_duration': '1s',\n    'preview_frame_color': 'black',\n    'body_color': '#232326',\n    'body_color_light': '#54545b',\n    'shadow_color': 'rgba(238,130,238, 0.5)',\n    'text_color': 'white',\n    'picture_height': '200px',\n    'picture_width': '300px',\n    'picture_edit_height': '200px',\n    'picture_edit_width': '300px',\n    'border_radius': '0.3rem',\n    'add_album_border': 'white 1px solid',\n    'add_album_font_size': '1rem',\n    'dialog_bg': 'black',\n    'preview_border_width': '10px'\n};\n\nmodule.exports = constants;\n\n\n// WEBPACK FOOTER //\n// ./constants/styles.js","import React from \"react\";\nimport {MagnifierIcon} from \"../Icons\";\nimport \"./picture.less\";\nimport Preview from \"./Preview\";\nimport {isVideo} from \"../../utils/index\";\nimport Loader from 'react-loaders';\nimport * as styles from \"../../constants/styles\";\nimport 'loaders.css/src/animations/ball-scale-multiple.scss';\n\n\nclass Picture extends React.Component {\n    // animation: fade, move\n\n    constructor(props) {\n        super(props);\n        this.imageLoadStarted = false;\n\n        this.state = {\n            magnify: '',\n            valid: true,\n            loading: true,\n        };\n    }\n\n    click() {\n        this.setState({\n            magnify: 'magnify',\n            animation: ''\n        });\n    };\n\n    closePreview() {\n        this.setState({\n            magnify: ''\n        });\n    }\n\n    mouseLeave(e) {\n        !this.state.magnify && this.chooseAnimation(e, 'fade_out', 'from');\n    };\n\n    mouseEnter(e) {\n        !this.state.magnify && this.chooseAnimation(e, 'fade_in', 'to');\n    };\n\n    chooseAnimation(e, fade, move) {\n        switch (this.props.animation) {\n            case 'fade':\n                this.setState({\n                    animation: fade\n                });\n                break;\n            case 'move':\n                this.setState({\n                    animation: this.findSide(e, move)\n                });\n        }\n    }\n\n    findSide(e, direction) {\n        const clientRect = e.target.getClientRects()[0];\n        const diffs = [\n            {\n                side: `move_${direction}_right`,\n                diff: Math.abs(e.clientX - clientRect.left)\n            }, {\n                side: `move_${direction}_left`,\n                diff: Math.abs(e.clientX - clientRect.right)\n            }, {\n                side: `move_${direction}_bottom`,\n                diff: Math.abs(e.clientY - clientRect.top)\n            }, {\n                side: `move_${direction}_top`,\n                diff: Math.abs(e.clientY - clientRect.bottom)\n            }\n        ];\n\n        const minDiff = Math.min(...Array.from(diffs, el => el.diff));\n        return diffs.find(el => el.diff == minDiff).side;\n    }\n\n    handleBrokenImg(e) {\n        this.imageLoadStarted = true;\n        this.setState({\n            loading: false,\n            valid: false\n        })\n    }\n\n    onLoad() {\n        this.imageLoadStarted = true;\n        this.setState({loading: false});\n    }\n\n    loadImage(url) {\n        let image = new Image();\n        image.onload = this.onLoad.bind(this);\n        image.onerror = this.handleBrokenImg.bind(this);\n        image.src = url;\n    }\n\n    render() {\n        const {album} = this.props;\n        const main = album.images[0];\n        const {animation, magnify, loading} = this.state;\n        if (!this.imageLoadStarted) this.loadImage(main.src);\n        //if (loading) return <Loader type=\"ball-scale-multiple\"/>;\n\n        return this.state.valid && <div className=\"image_main_wrapper\">\n                <div\n                    className={`image_wrapper ${animation} ${magnify}`}\n                    onMouseLeave={(e) => this.mouseLeave(e)}\n                    onMouseEnter={(e) => this.mouseEnter(e)}\n                    onClick={(e) => this.click(e)}\n                >\n                    {loading\n                        ? <Loader type=\"ball-scale-multiple\" className=\"image_loader\"/>\n                        : isVideo(main.src)\n                            ? <video height={styles.picture_height}\n                                     width={styles.picture_width}\n                                     className=\"video\">\n                                <source src={main.src}/>\n                            </video>\n                            : <img className='image'\n                                   src={main.src}\n                                   alt=\"something wrong happens\"/>}\n                    <div className={'overlay'}>\n                        <div className={`overlay_top`}>\n                            <MagnifierIcon/>\n                        </div>\n                        <div className={`overlay_bottom`}>\n                            <div className='overlay_bottom_text'>{album.name}</div>\n                        </div>\n                    </div>\n                </div>\n                {magnify && [<div key=\"preview_overlay\" className=\"preview_overlay\"/>,\n                <Preview main={main}\n                         key=\"preview\"\n                         close={() => this.closePreview()}\n                         editRoute={`/edit/${album._id}`}\n                         images={album.images}/>]}\n            </div>;\n    }\n}\n\nexport default Picture;\n\n\n\n\n// WEBPACK FOOTER //\n// ./components/picture/Picture.jsx","import React from \"react\";\nimport styled, {keyframes} from 'styled-components';\n//import { Scrollbars } from 'react-custom-scrollbars';\nimport './preview.less';\nimport PreviewImageFrame from \"./PreviewImageFrame\";\nimport constants from '../../constants/styles';\nimport Scroll from \"../scroll/Scroll\";\n\nconst BottomSection = styled.div`\n   width: ${props => props.imageWidth};\n`\n\nconst increase = (props) => keyframes`\n   0% {\n      height: 0;\n      width: 0;\n      background-color: transparent;\n  }\n  50% {\n      height: 90%;\n      width: ${props.imageWidth};\n      background-color: transparent;  \n  }\n  100% {\n      background-color: ${constants.preview_frame_color};\n  }\n`\n\nconst decrease = (props) => keyframes`\n   0% {\n      background-color: ${constants.preview_frame_color};\n   }\n   50% {\n      height: 90%;\n      width: ${props.imageWidth};\n      background-color: transparent;\n  }\n  100% {\n      height: 0;\n      width: 0;\n      background-color: transparent;\n  }\n`\n\nconst Modal = styled.div`\n&.increase {\n  .magnify_modal_img_frame {\n    animation: ${increase} ${props => props.animationTime}s ease;\n  }\n}\n\n&.decrease {\n  .magnify_modal_img_frame {\n    animation: ${decrease} ${props => props.animationTime}s ease;\n  }\n}\n`\n\nclass Preview extends React.Component {\n\n    constructor(props) {\n        super(props);\n\n        this.animationTime = parseInt(constants['preview_animation_duration']);\n\n        this.state = {\n            imageWidth: 0,\n            animate: '',\n            currentSlide: props.main\n        };\n    }\n\n    setImageWidth(width) {\n        this.setState({\n            imageWidth: width,\n        });\n    }\n\n    clearAnimate(slide) {\n        this.setState({\n            animate: '',\n            currentSlide: slide\n        });\n    }\n\n    close() {\n        this.props.close();\n    }\n\n    clearAnimation(slide) {\n        this.setState({\n            animate: ''\n        });\n    }\n\n\n    calculateTextWidth(imgWidth) {\n        const bottomSection = document.getElementsByClassName('magnify_modal_img_frame_bottom')[0];\n        if(bottomSection){\n            const style = bottomSection.currentStyle || window.getComputedStyle(bottomSection);\n            const paddings = parseFloat(style.paddingLeft) + parseFloat(style.paddingRight);\n            return parseFloat(imgWidth) - paddings;\n        }\n        return 0;\n    }\n\n    calculateTextHeight() {\n        const bottomSection = document.getElementsByClassName('magnify_modal_img_frame_bottom')[0];\n\n        if(bottomSection && this.caption){\n            const bottomSectionStyle = bottomSection.currentStyle || window.getComputedStyle(bottomSection);\n            const paddings = parseFloat(bottomSectionStyle.paddingTop) + parseFloat(bottomSectionStyle.paddingBottom);\n\n            const captionStyle = this.caption.currentStyle || window.getComputedStyle(this.caption);\n            return parseFloat(bottomSectionStyle.height) - paddings - parseFloat(captionStyle.height);\n        }\n        return 0;\n    }\n\n    render() {\n        const {animate, imageWidth} = this.state;\n        const {images, main} = this.props;\n\n        return (\n            <Modal className={`magnify_modal`}\n                   imageWidth={imageWidth}\n                   animationTime={this.animationTime}>\n                <div className={`magnify_modal_img_frame`}>\n                    <PreviewImageFrame main={main}\n                                       images={images}\n                                       editRoute={this.props.editRoute}\n                                       setImageWidth={(width) => {\n                                           this.setImageWidth(width)\n                                       }}\n                                       close={() => this.close()}\n                                       clearAnimate={(s) => this.clearAnimate(s)}\n                    />\n\n                    <BottomSection className='magnify_modal_img_frame_bottom'\n                                   imageWidth={imageWidth}>\n\n                        <div className='magnify_modal_img_frame_bottom_caption' ref={r => this.caption = r }>{this.state.currentSlide.name}</div>\n\n                        <Scroll height={this.calculateTextHeight()}\n                                width={this.calculateTextWidth(imageWidth)}\n                                className='magnify_modal_img_frame_bottom_text'\n                                progress={true}>\n                            <div>{this.state.currentSlide.text}</div>\n                        </Scroll>\n\n                    </BottomSection>\n\n                </div>\n            </Modal>\n        );\n    }\n}\n\nexport default Preview;\n\n\n// WEBPACK FOOTER //\n// ./components/picture/Preview.jsx","import React from \"react\";\nimport {CrossIcon, EditIcon, LeftArrowIcon, RightArrowIcon} from \"../Icons\";\nimport \"./preview.less\";\nimport {Link} from \"react-router-dom\";\nimport {isVideo} from \"../../utils/index\";\nimport constants from '../../constants/styles';\nimport Loader from 'react-loaders';\nimport 'loaders.css/src/animations/ball-scale-multiple.scss';\n\nclass PreviewImageFrame extends React.Component {\n\n  constructor(props) {\n    super(props);\n\n    this.img = null;\n\n    const current = props.images.find(img => img.src === props.main.src);\n    const currentIndex = props.images.indexOf(current);\n\n    this.state = {\n      imageWidth: 0,\n      main: props.main,\n      left: currentIndex > 0,\n      right: currentIndex < (props.images.length - 1),\n      images: props.images,\n      index: currentIndex\n    };\n  }\n\n  componentDidMount() {\n    this.height = this.getContainerHeight();\n    window.addEventListener('resize', () => this.recalculateWidth());\n  }\n\n  getContainerHeight() {\n    if (this.cont) {\n        const containerStyle = this.cont.currentStyle || window.getComputedStyle(this.cont);\n        return parseFloat(containerStyle.height);\n    }\n    return 0;\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', () => this.recalculateWidth());\n  }\n\n  recalculateWidth() {\n    const naturalWidth = this.state.images[this.state.index].naturalWidth;\n    const naturalHeight = this.state.images[this.state.index].naturalHeight;\n\n    if (naturalWidth && naturalHeight &&  this.cont) {\n        this.height = this.getContainerHeight();\n        let width = naturalWidth * this.height/ naturalHeight;\n        if((width + parseFloat(constants.preview_border_width) * 2) > window.innerWidth) {\n            width  = window.innerWidth - parseFloat(constants.preview_border_width) * 2;\n            const height = naturalHeight * width / naturalWidth;\n            this.cont.style.height = height;\n        }\n        this.cont.style.width = width;\n        this.props.setImageWidth(width);\n    }\n\n  }\n\n  onLoad(e) {\n    let width = e.target.naturalWidth * this.height / e.target.naturalHeight;\n    let newImages = [...this.state.images];\n    newImages[this.state.index].naturalWidth = e.target.naturalWidth;\n    newImages[this.state.index].naturalHeight = e.target.naturalHeight;\n    newImages[this.state.index].loaded = true;\n      if((width + parseFloat(constants.preview_border_width) * 2) > window.innerWidth) {\n          width  = window.innerWidth - parseFloat(constants.preview_border_width) * 2;\n          const height = e.target.naturalHeight * width / e.target.naturalWidth;\n          this.cont.style.height = height;\n\n      }\n    this.cont.style.width = width;\n    this.setState({images: newImages});\n    this.props.setImageWidth(width);\n  }\n\n  onCrossClick() {\n    this.props.close();\n  }\n\n  onArrowClick(arrow) {\n    const {images} = this.props;\n    const currentIndex = images.indexOf(this.state.main);\n    let main;\n\n    if (arrow === 'left' && currentIndex > 0) {\n      main = images[currentIndex - 1];\n      this.setState({\n        main,\n        left: (currentIndex - 1) > 0,\n        right: (currentIndex - 1) < (images.length - 1),\n        index: currentIndex - 1\n      }, this.recalculateWidth);\n    }\n\n    if (arrow === 'right' && currentIndex < (images.length - 1)) {\n        main = images[currentIndex + 1];\n        this.setState({\n        main,\n        left: (currentIndex + 1) > 0,\n        right: (currentIndex + 1) < (images.length - 1),\n        index: currentIndex + 1\n      }, this.recalculateWidth)\n    }\n\n    this.props.clearAnimate(main);\n  }\n\n  loadImageURL (imageURL) {\n        const imageObj = new Image();\n        imageObj.onload = this.onLoad.bind(this);\n        imageObj.onerror = this.onLoadFailure.bind(this);\n        imageObj.src = imageURL;\n  }\n\n  onLoadFailure() {\n      let newImages = [...this.state.images];\n      newImages[this.state.index].loaded = true;\n      this.setState({images: newImages});\n  }\n\n  render() {\n    const {main, left, right, images, index} = this.state;\n    const {editRoute} = this.props;\n    if(!images[index].loaded) this.loadImageURL(images[index].src);\n\n    return (<div className='magnify_modal_img_frame_container' ref={cont => this.cont = cont}>\n        <CrossIcon className='cross' onClick={() => this.onCrossClick()}/>\n            {editRoute && <Link to={this.props.editRoute}><EditIcon className='edit'/></Link>}\n        {left && <div className='left_arrow'>\n          <LeftArrowIcon onClick={() => this.onArrowClick('left')}/>\n        </div>}\n        {right && <div className='right_arrow'>\n          <RightArrowIcon onClick={() => this.onArrowClick('right')}/>\n        </div>}\n        <div className='counter_container'>\n          <div className='counter'>{`${(images.indexOf(main) + 1)} of ${images.length}`}</div>\n        </div>\n        {!images[index].loaded ? <Loader type=\"ball-scale-multiple\"/> : isVideo(main.src)\n            ? <video controls=\"controls\"\n                     ref={node => this.img = node}\n                     //onLoad={(e) => this.onLoad(e)}\n                     className=\"image_preview\"\n                     >\n              <source src={main.src}/>\n            </video>\n            :<img\n                //onLoad={(e) => this.onLoad(e)}\n                  src={main.src} className='image_preview'\n                  ref={node => this.img = node}/>}\n      </div>\n    );\n  }\n}\n\nexport default PreviewImageFrame;\n\n\n// WEBPACK FOOTER //\n// ./components/picture/PreviewImageFrame.jsx","import React from 'react';\nimport './editAlbum.less';\nimport FileInput from \"../fileInput/FileInput\";\nimport {CrossIcon, SaveIcon} from \"../Icons\";\nimport Card from \"./Card\";\nimport http from '../../HttpService';\nimport connect from \"react-redux/es/connect/connect\";\nimport {\n    deleteAlbum, deleteFotoFromAlbum, saveAlbumDescription,\n    saveFotoDescription, saveItemsOrder\n} from \"../../actions/albumActions\";\nimport Dialog from \"../dialog/Dialog\";\nimport EditCanvas from \"./EditCanvas\";\nimport {isVideo} from \"../../utils/index\";\nimport * as styles from \"../../constants/styles\";\nconst routesModule = require('../../constants/routes');\nimport Loader from 'react-loaders';\nimport 'loaders.css/src/animations/ball-scale-multiple.scss';\nimport 'loaders.css/src/animations/ball-grid-pulse.scss';\n\n@connect(store => ({}), {\n    deleteFotoFromAlbum,\n    saveFotoDescription,\n    saveAlbumDescription,\n    deleteAlbum,\n    saveItemsOrder\n})\nclass EditAlbum extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            dragStarted: false,\n            dragFrom: null,\n            dragFromEl: null,\n            dragObj: null,\n            openPicture: null,\n            openedAlbum: false,\n            album: null,\n            openedDialog: false,\n            imageDownloaded: false,\n            imageLoading: true,\n            imageLoadStarted: false,\n            albumLoading: false\n        }\n    }\n\n    componentDidMount() {\n        this.loadAlbum();\n    }\n\n    loadAlbum() {\n        this.setState({albumLoading: true});\n        http.doGet(routesModule.routes.GET_ALBUM(this.props.match.params.id))\n            .then(result => {\n                result.images.sort((x, y) => x.order - y.order);\n                result.images.forEach(image => image.src = image.src + '?forceUpdate=' + new Date().toISOString())\n                this.setState({album: result, albumLoading: false})\n            });\n    }\n\n    openDetails(picture) {\n        this.setState({openPicture: picture});\n    }\n\n    openAlbumDetails() {\n        this.setState({openedAlbum: true});\n    }\n\n    onCrossClick() {\n        this.setState({openPicture: null, openedAlbum: false});\n    }\n\n    deleteItem(picture) {\n        if (this.state.album.images.length == 1) {\n            this.setState({openedDialog: true});\n            return;\n        }\n\n        this.props.deleteFotoFromAlbum(picture._id);\n        const newPictures = this.state.album.images.filter(p => p._id != picture._id);\n        const newAlbum = Object.assign({}, {\n            ...this.state.album,\n            images: newPictures,\n        })\n        this.setState({album: newAlbum});\n    }\n\n    removeAlbum() {\n        this.props.deleteAlbum(this.state.album._id);\n        this.props.history.push('/');\n    }\n\n    changeState(obj) {\n        this.setState(obj);\n    }\n\n    saveFotoDescription(picture) {\n        const newPictures = [...this.state.album.images];\n        const editedPicture = this.state.album.images.find(p => p._id == picture._id);\n        if (this.pinput.value) editedPicture.name = this.pinput.value;\n        if (this.ptextarea.value) editedPicture.text = this.ptextarea.value;\n\n        this.props.saveFotoDescription(this.state.album._id, editedPicture);\n\n        const newAlbum = Object.assign({}, {\n            ...this.state.album,\n            images: newPictures,\n        });\n        this.setState({album: newAlbum, openPicture: null});\n    }\n\n    saveAlbumDescription() {\n        const editedAlbum = Object.assign({}, {...this.state.album});\n        if (this.ainput.value) editedAlbum.name = this.ainput.value;\n        if (this.atextarea.value) editedAlbum.description = this.atextarea.value;\n\n        this.props.saveAlbumDescription(editedAlbum);\n\n        this.setState({album: editedAlbum, openedAlbum: false});\n    }\n\n    uploadFile(file) {\n        http.sendFile(routesModule.routes.UPLOAD_FOTO, file)\n            .then(downloadedFoto => {\n                if (isVideo(downloadedFoto.src)) {\n                    http.doPost(routesModule.routes.FOTO_ROUTE, {\n                        src: downloadedFoto.src,\n                        album: this.state.album._id\n                    }).then(result => {\n                        const newPictures = [...this.state.album.images];\n                        newPictures.push(result);\n                        const newAlbum = Object.assign({}, {\n                            ...this.state.album,\n                            images: newPictures,\n                        });\n\n                        this.setState({\n                            //imageDownloaded: null,\n                            album: newAlbum\n                        });\n                    });\n                } else {\n                    this.setState({\n                        imageDownloaded: downloadedFoto.src\n                    });\n                }\n\n            });\n    }\n\n    onImageLoad() {\n        this.setState({imageLoading: false, });\n    }\n\n    onImageError() {\n        this.setState({imageLoading: false});\n    }\n\n    loadImage(src) {\n        this.setState({imageLoadStarted: true});\n        const imageObj = new Image()\n        imageObj.onload = this.onImageLoad.bind(this);\n        imageObj.onerror = this.onImageError.bind(this);\n        imageObj.src = src;\n    }\n\n    renderEditAlbumCard() {\n        if(!this.state.imageLoadStarted) this.loadImage(this.state.album.images[0].src);\n        return <div className='edit_album_card' key=\"edit_album_card\">\n            {this.state.imageLoading ? <Loader type=\"ball-scale-multiple\"/> : isVideo(this.state.album.images[0].src)\n                ? <video className=\"album_image\"\n                         height={styles.picture_edit_height}\n                         width={styles.picture_edit_width}\n                         controls=\"controls\">\n                    <source src={this.state.album.images[0].src}/>\n                </video>\n                : <img className='album_image'\n                       src={this.state.album.images[0].src}/>}\n            <div className='album_name' onClick={() => this.openAlbumDetails()}>{this.state.album.name}</div>\n            <CrossIcon className='cross_icon' onClick={() => this.setState({openedDialog: true})}/>\n        </div>\n    }\n\n    renderImages() {\n        return this.state.album.images.sort((x, y) => x.order - y.order).map(p => <Card\n            key={p._id}\n            picture={p}\n            pictures={this.state.album.images}\n            openDetails={(p) => this.openDetails(p)}\n            deleteItem={(p) => this.deleteItem(p)}\n            replaceImage={(target) => this.replaceImage(target)}\n            openPicture={this.state.openPicture}\n            changeDragState={(obj) => this.changeState(obj)}\n            dragState={this.state}\n            updateOrder={(album) => this.props.saveItemsOrder(album)}\n            loadAlbum={() => this.loadAlbum()}\n        />)\n    }\n\n    renderFileInput() {\n        return !this.state.imageDownloaded && <FileInput className='edit_file_input'\n                                                         disabled={this.state.openPicture}\n                                                         label='Choose new foto'\n                                                         uploadFile={(file) => this.uploadFile(file)}\n            />\n    }\n\n    renderEditCanvas() {\n        return this.state.imageDownloaded && !isVideo(this.state.imageDownloaded) && <EditCanvas\n                image={this.state.imageDownloaded}\n                cleanImage={obj => this.changeState(obj)}\n                album={this.state.album}\n            />\n    }\n\n    renderChangeFotoTextInfoDialog() {\n        return this.state.openPicture &&\n            <div className='new_text_overlay'>\n                <div className='new_text'>\n                    <div className=\"new_text_caption\">Enter foto name and description:</div>\n                    <SaveIcon className='save_icon' onClick={() => this.saveFotoDescription(this.state.openPicture)}/>\n                    <CrossIcon className='cross_icon' onClick={() => this.onCrossClick()}/>\n                    <input defaultValue={this.state.openPicture.name} ref={i => this.pinput = i}/>\n                    <textarea defaultValue={this.state.openPicture.text} ref={t => this.ptextarea = t}/>\n                </div>\n            </div>\n    }\n\n    renderChangeAlbumTextInfoDialog() {\n        return this.state.openedAlbum &&\n            <div className='new_text_overlay'>\n                <div className='new_text'>\n                    <div className=\"new_text_caption\">Enter album name and description:</div>\n                    <SaveIcon className='save_icon' onClick={() => this.saveAlbumDescription()}/>\n                    <CrossIcon className='cross_icon' onClick={() => this.onCrossClick()}/>\n                    <input defaultValue={this.state.album.name} ref={i => this.ainput = i}/>\n                    <textarea defaultValue={this.state.album.description} ref={t => this.atextarea = t}/>\n                </div>\n            </div>\n    }\n\n    renderDeleteDialog() {\n        return this.state.openedDialog && <Dialog onClick={() => this.removeAlbum()}\n                                                  onClose={() => this.setState({openedDialog: false})}\n                                                  text=\"Do you really want to delete the album?\"/>\n    }\n\n\n    render() {\n        const {album, albumLoading} = this.state;\n        if(albumLoading) return <Loader type=\"ball-grid-pulse\" className='Data_loader'/>;\n        if (!album) return null;\n\n        return <React.Fragment>\n            {this.renderEditAlbumCard()}\n            {this.renderImages()}\n            {this.renderFileInput()}\n            {this.renderEditCanvas()}\n            {this.renderChangeFotoTextInfoDialog()}\n            {this.renderChangeAlbumTextInfoDialog()}\n            {this.renderDeleteDialog()}\n        </React.Fragment>;\n    }\n}\n\nexport default EditAlbum;\n\n\n\n// WEBPACK FOOTER //\n// ./components/editAlbum/EditAlbum.jsx","import React from 'react';\nimport './editAlbum.less';\nimport {CrossIcon, EditIcon} from \"../Icons\";\nimport {isVideo} from \"../../utils/index\";\nimport Loader from 'react-loaders';\nimport 'loaders.css/src/animations/ball-scale-multiple.scss';\nimport * as styles from \"../../constants/styles\";\n\nclass Card extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.replaceEvent = 'replace';\n        this.state = {\n            imageLoading: true,\n            imageLoadStarted: false\n        }\n    }\n\n\n    componentWillReceiveProps() {\n        if (this.dragContainer && !this.replaceAttached) {\n            this.replaceAttached = true;\n            this.dragContainer.addEventListener(this.replaceEvent, e => this.replaceImage(e.target));\n            document.body.addEventListener('mouseup', e => this.onUpBody(e));\n        }\n    }\n\n    onUpBody(e) {\n        const elementAtPoint = document.elementFromPoint(e.clientX + window.scrollX, e.clientY + window.scrollY)\n            .parentElement;\n        if (!elementAtPoint.classList.contains('drag_container')) {\n            this.props.changeDragState({dragStarted: false, dragFrom: null, dragObj: null, dragFromEl: null});\n        }\n    }\n\n    replaceImage(target) {\n        const attr = target.getAttribute('imgid');\n        const picture = this.props.pictures.find(p => p._id == attr);\n\n        this.changePictureAndClear(picture);\n    }\n\n    onMouseDown(e, picture) {\n        e.preventDefault();\n\n        const target = e.target.parentElement;\n\n        const x = e.clientX + window.scrollX;\n        const y = e.clientY + window.scrollY;\n\n        const style = target.currentStyle || window.getComputedStyle(target);\n\n        const elStartLeft = parseInt(style.left, 10);\n        const elStartTop = parseInt(style.top, 10);\n        const dragObj = {\n            x, y, elStartLeft, elStartTop\n        }\n        target.style.zIndex = 10;\n        this.props.changeDragState({dragStarted: true, dragFrom: picture, dragObj, dragFromEl: target});\n        target.style.zIndex = 10;\n    }\n\n    onMouseMove(e, picture) {\n        e.preventDefault();\n        const {dragFrom, dragStarted, dragObj} = this.props.dragState;\n        const target = e.target.parentElement;\n        if (dragStarted && dragFrom == picture) {\n            const x = e.clientX + window.scrollX;\n            const y = e.clientY + window.scrollY;\n            target.style.top = (dragObj.elStartTop + y - dragObj.y) + 'px';\n            target.style.left = (dragObj.elStartLeft + x - dragObj.x) + 'px';\n        }\n    }\n\n    onMouseUp(e, picture) {\n        e.preventDefault();\n\n        const {dragFrom, dragFromEl} = this.props.dragState;\n        const target = e.target.parentElement;\n\n        if(!dragFromEl) {\n            return;\n        }\n\n        dragFromEl.style.top = '0px';\n        dragFromEl.style.left = '0px';\n\n        target.style.top = '0px';\n        target.style.left = '0px';\n\n        dragFromEl.style.zIndex = 0;\n\n        if (picture == dragFrom) {\n            const event = new Event(this.replaceEvent);\n            const elementAtPoint = document.elementFromPoint(e.clientX + window.scrollX, e.clientY + window.scrollY)\n                .parentElement;\n            if (elementAtPoint.classList.contains('drag_container')) {\n                elementAtPoint.dispatchEvent(event);\n            } else {\n                this.props.changeDragState({dragStarted: false, dragFrom: null, dragObj: null, dragFromEl: null});\n            }\n\n            return;\n        }\n\n        this.changePictureAndClear(picture);\n    }\n\n    changePictureAndClear(picture) {\n        const {dragFrom, album} = this.props.dragState;\n\n        const newPictures = [...album.images];\n\n        const dragToPicture = album.images.find(p => p._id == picture._id);\n       // editedPicture.order = prevOrder;\n        const dragFromPicture = album.images.find(p => p._id == dragFrom._id);\n\n        const prevOrder = dragFromPicture.order;\n        dragFromPicture.order = dragToPicture.order;\n        dragToPicture.order = prevOrder;\n\n        newPictures.sort((x, y) => x.order - y.order);\n\n        const newAlbum = Object.assign({}, {\n            ...album,\n            images: newPictures,\n        });\n\n        this.props.updateOrder(newAlbum);\n        this.props.changeDragState({dragStarted: false, dragFrom: null, dragObj: null, dragFromEl: null, album: newAlbum});\n    }\n\n    onImageLoad() {\n        this.setState({imageLoading: false});\n    }\n\n    onImageError() {\n        this.setState({imageLoading: false});\n    }\n\n    loadImage(src) {\n        this.setState({imageLoadStarted: true});\n        const imageObj = new Image();\n        imageObj.onload = this.onImageLoad.bind(this);\n        imageObj.onerror = this.onImageError.bind(this);\n        imageObj.src = src;\n    }\n\n    render() {\n        const {picture, openPicture} = this.props;\n        const {imageLoading, imageLoadStarted} = this.state;\n        if (!imageLoadStarted && picture) this.loadImage(picture.src);\n        return openPicture\n            ? <div className='drag_container'\n                   imgid={picture._id}>\n                <img className='drag_image'\n                     src={picture.src}\n                     draggable={false}/>\n            </div>\n            : <div className='drag_container'\n                   ref={r => this.dragContainer = r}\n                   imgid={picture._id}\n                   draggable={true}\n                   onMouseDown={e => this.onMouseDown(e, picture)}\n                   onMouseUp={e => this.onMouseUp(e, picture)}\n                   onMouseMove={e => this.onMouseMove(e, picture)}>\n                {imageLoading ? <Loader type=\"ball-scale-multiple\"/> : isVideo(picture.src)\n                    ? <video height={styles.picture_edit_height}\n                             controls=\"controls\"\n                             className='drag_image'>\n                    <source src={picture.src}/>\n                </video>\n                    : <img className='drag_image' src={picture.src}/>}\n                <CrossIcon className='cross_icon' onClick={() => this.props.deleteItem(picture)}/>\n                <EditIcon className='edit_icon' onClick={() => this.props.openDetails(picture)}/>\n                <div className='text_description' onClick={() => this.props.openDetails(picture)}>{picture.name}</div>\n            </div>\n    }\n}\n\nexport default Card;\n\n\n\n// WEBPACK FOOTER //\n// ./components/editAlbum/Card.jsx","import React from 'react';\nimport './editCanvas.less';\nimport {CrossIcon, RotateIcon, SaveIcon} from \"../Icons\";\nimport AvatarEditor from \"./ImageRotater\";\nimport * as styles from \"../../constants/styles\";\nconst routesModule = require('../../constants/routes');\nimport http from '../../HttpService';\n\nclass EditCanvas extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            angle: 0,\n            width: parseInt(styles.picture_edit_width),\n            height: parseInt(styles.picture_edit_height),\n            imageLoading: true\n        }\n    }\n\n    getEditedImage() {\n        const {album, image} = this.props;\n        this.avatar.getImage().toBlob(img => {\n            let name = image.split('/');\n            name = name[name.length - 1];\n            const file = new File([img], name);\n\n            http.sendFile(routesModule.routes.UPLOAD_FOTO, file)\n                .then(downloadedFoto => {\n                    http.doPost(routesModule.routes.FOTO_ROUTE, {\n                        src: downloadedFoto.src,\n                        album: album._id\n                    }).then(result => {\n                            const newPictures = [...album.images];\n                            newPictures.push(result);\n                            const newAlbum = Object.assign({}, {\n                                ...album,\n                                images: newPictures,\n                            });\n\n                            this.props.cleanImage({\n                                imageDownloaded: null,\n                                album: newAlbum\n                            });\n                        });\n                });\n        });\n    }\n\n    rotateImage() {\n        const newAngle = this.state.angle + 90;\n        this.calculateParameters(newAngle);\n    }\n\n    calculateParameters(newAngle) {\n        const newState = {\n            height: parseInt(styles.picture_edit_height),\n            angle : newAngle\n        };\n        newState.width = newAngle % 180 == 0\n            ? parseInt(this.naturalWidth * this.state.height / this.naturalHeight)\n            : parseInt(this.naturalHeight * this.state.height / this.naturalWidth);\n        this.setState(newState);\n    }\n\n    onLoad(imgInfo) {\n        this.setState({imageLoading: false});\n        this.naturalWidth = imgInfo.naturalWidth;\n        this.naturalHeight = imgInfo.naturalHeight;\n\n        this.calculateParameters(this.state.angle);\n    }\n\n    onImageFailure() {\n        this.setState({imageLoading: false});\n    }\n\n    closeImage() {\n        this.props.cleanImage({imageDownloaded: false});\n    }\n\n    render() {\n        const {image} = this.props;\n        const {angle, width, height, imageLoading} = this.state;\n        return <div className=\"Edit_canvas\">\n            <AvatarEditor\n                ref={ae => this.avatar = ae}\n                image={image}\n                rotate={angle}\n                width={width}\n                height={height}\n                onLoadSuccess={(imgInfo) => this.onLoad(imgInfo)}\n                onLoadFailure={() => this.onImageFailure()}\n                loading={imageLoading}\n            />\n            <RotateIcon className='rotate_icon' onClick={() => this.rotateImage()}/>\n            <SaveIcon className='save_icon' onClick={() => this.getEditedImage()}/>\n            <CrossIcon className='cross_icon' onClick={() => this.closeImage()}/>\n        </div>\n    }\n}\n\nexport default EditCanvas;\n\n\n\n// WEBPACK FOOTER //\n// ./components/editAlbum/EditCanvas.jsx"],"sourceRoot":""}