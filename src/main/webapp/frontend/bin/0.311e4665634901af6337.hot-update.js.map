{"version":3,"sources":["webpack:///./components/editAlbum/Card.jsx"],"names":["Card","React","Component","constructor","props","replaceEvent","componentWillReceiveProps","dragContainer","replaceAttached","addEventListener","e","replaceImage","target","dragFrom","dragState","attr","getAttribute","picture","pictures","find","p","id","changePictureAndClear","onMouseDown","preventDefault","parentElement","x","clientX","window","scrollX","y","clientY","scrollY","style","currentStyle","getComputedStyle","elStartLeft","parseInt","left","elStartTop","top","dragObj","changeDragState","dragStarted","dragFromEl","zIndex","onMouseMove","onMouseUp","event","Event","document","elementFromPoint","dispatchEvent","prevOrder","order","render","isTextOpen","src","r","openDetails","deleteItem"],"mappings":"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","file":"0.311e4665634901af6337.hot-update.js","sourcesContent":["import React from 'react';\nimport './editAlbum.less';\nimport {CrossIcon, EditIcon} from \"../Icons\";\n\nclass Card extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.replaceEvent = 'replace';\n    }\n\n    componentWillReceiveProps() {\n        if (this.dragContainer && !this.replaceAttached) {\n            this.replaceAttached = true;\n            this.dragContainer.addEventListener(this.replaceEvent, e => this.replaceImage(e.target));\n        }\n    }\n\n    replaceImage(target) {\n        const {dragFrom} = this.props.dragState;\n\n        const attr = target.getAttribute('imgid');\n        const picture = this.pictures.find(p => p.id == attr);\n\n        this.changePictureAndClear(dragFrom, picture);\n    }\n\n    onMouseDown(e, picture) {\n        e.preventDefault();\n\n        const target = e.target.parentElement;\n\n        const x = e.clientX + window.scrollX;\n        const y = e.clientY + window.scrollY;\n\n        const style = target.currentStyle || window.getComputedStyle(target);\n\n        const elStartLeft = parseInt(style.left, 10);\n        const elStartTop = parseInt(style.top, 10);\n        const dragObj = {\n            x, y, elStartLeft, elStartTop\n        }\n        this.props.changeDragState({dragStarted: true, dragFrom: picture, dragObj, dragFromEl: target});\n        target.style.zIndex = 10;\n    }\n\n    onMouseMove(e, picture) {\n        e.preventDefault();\n        const {dragFrom, dragStarted, dragObj} = this.props.dragState;\n        const target = e.target.parentElement;\n        if (dragStarted && dragFrom == picture) {\n            const x = e.clientX + window.scrollX;\n            const y = e.clientY + window.scrollY;\n            target.style.top = (dragObj.elStartTop + y - dragObj.y) + 'px';\n            target.style.left = (dragObj.elStartLeft + x - dragObj.x) + 'px';\n        }\n    }\n\n    onMouseUp(e, picture) {\n        e.preventDefault();\n\n        const {dragFrom, dragFromEl} = this.props.dragState;\n        const target = e.target.parentElement;\n\n        dragFromEl.style.top = '0px';\n        dragFromEl.style.left = '0px';\n\n        target.style.top = '0px';\n        target.style.left = '0px';\n\n        dragFromEl.style.zIndex = 0;\n\n        if (picture == dragFrom) {\n            const event = new Event(this.replaceEvent);\n            document.elementFromPoint(e.clientX + window.scrollX, e.clientY + window.scrollY)\n                .parentElement\n                .dispatchEvent(event);\n            return;\n        }\n\n        this.changePictureAndClear(dragFrom, picture);\n    }\n\n    changePictureAndClear(dragFrom, picture) {\n        this.props.changeDragState({dragStarted: false, dragFrom: null, dragObj: null, dragFromEl: null});\n\n        const prevOrder = dragFrom.order;\n        dragFrom.order = picture.order;\n        picture.order = prevOrder;\n    }\n\n    render() {\n        const {picture, isTextOpen} = this.props;\n        return isTextOpen\n            ? <div className='drag_container'\n                   imgid={picture.id}>\n                <img className='drag_image'\n                     src={picture.src}\n                     draggable={false}/>\n            </div>\n            : <div className='drag_container'\n                   ref={r => this.dragContainer = r}\n                   imgid={picture.id}\n                   draggable={true}\n                   onDoubleClick={this.props.openDetails}\n                   onMouseDown={e => this.onMouseDown(e, picture)}\n                   onMouseUp={e => this.onMouseUp(e, picture)}\n                   onMouseMove={e => this.onMouseMove(e, picture)}>\n                <img className='drag_image' src={picture.src}/>\n                <CrossIcon className='cross_icon' onClick={this.props.deleteItem}/>\n                <EditIcon className='edit_icon' onClick={this.props.openDetails}/>\n            </div>\n    }\n}\n\nexport default Card;\n\n\n\n// WEBPACK FOOTER //\n// ./components/editAlbum/Card.jsx"],"sourceRoot":""}