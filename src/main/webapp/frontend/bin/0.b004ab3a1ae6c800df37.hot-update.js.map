{"version":3,"sources":["webpack:///./components/editAlbum/Card.jsx"],"names":["Card","React","Component","constructor","props","replaceEvent","componentWillReceiveProps","dragContainer","replaceAttached","addEventListener","e","replaceImage","target","dragFrom","dragState","attr","getAttribute","picture","pictures","find","p","id","changeDragState","dragStarted","dragObj","dragFromEl","prevOrder","order","onMouseDown","preventDefault","parentElement","x","clientX","window","scrollX","y","clientY","scrollY","style","currentStyle","getComputedStyle","elStartLeft","parseInt","left","elStartTop","top","zIndex","onMouseMove","onMouseUp","event","Event","document","elementFromPoint","dispatchEvent","render","isTextOpen","src","r","openDetails","deleteItem"],"mappings":"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","file":"0.b004ab3a1ae6c800df37.hot-update.js","sourcesContent":["import React from 'react';\nimport './editAlbum.less';\nimport {CrossIcon, EditIcon} from \"../Icons\";\n\nclass Card extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.replaceEvent = 'replace';\n  }\n\n  componentWillReceiveProps() {\n    if (this.dragContainer && !this.replaceAttached) {\n      this.replaceAttached = true;\n      this.dragContainer.addEventListener(this.replaceEvent, e => this.replaceImage(e.target));\n    }\n  }\n\n  replaceImage(target) {\n    const {dragFrom} = this.props.dragState;\n\n    const attr = target.getAttribute('imgid');\n    const picture = this.pictures.find(p => p.id == attr);\n\n    this.props.changeDragState({dragStarted: false, dragFrom: null, dragObj: null, dragFromEl: null});\n\n    const prevOrder = dragFrom.order;\n    dragFrom.order = picture.order;\n    picture.order = prevOrder;\n  }\n\n  onMouseDown(e, picture) {\n    e.preventDefault();\n\n    const target = e.target.parentElement;\n\n    const x = e.clientX + window.scrollX;\n    const y = e.clientY + window.scrollY;\n\n    const style = target.currentStyle || window.getComputedStyle(target);\n\n    const elStartLeft = parseInt(style.left, 10);\n    const elStartTop = parseInt(style.top, 10);\n    const dragObj = {\n      x, y, elStartLeft, elStartTop\n    }\n    this.props.changeDragState({dragStarted: true, dragFrom: picture, dragObj, dragFromEl: target});\n    target.style.zIndex = 10;\n  }\n\n  onMouseMove(e, picture) {\n    e.preventDefault();\n    const {dragFrom, dragStarted, dragObj} = this.props.dragState;\n    const target = e.target.parentElement;\n    if (dragStarted && dragFrom == picture) {\n      const x = e.clientX + window.scrollX;\n      const y = e.clientY + window.scrollY;\n      target.style.top = (dragObj.elStartTop + y - dragObj.y) + 'px';\n      target.style.left = (dragObj.elStartLeft + x - dragObj.x) + 'px';\n    }\n  }\n\n  onMouseUp(e, picture) {\n    e.preventDefault();\n\n    const {dragFrom, dragFromEl} = this.props.dragState;\n    const target = e.target.parentElement;\n\n    dragFromEl.style.top = '0px';\n    dragFromEl.style.left = '0px';\n\n    target.style.top = '0px';\n    target.style.left = '0px';\n\n    dragFromEl.style.zIndex = 0;\n\n    if (picture == dragFrom) {\n      const event = new Event(this.replaceEvent);\n      document.elementFromPoint(e.clientX + window.scrollX, e.clientY + window.scrollY)\n        .parentElement\n        .dispatchEvent(event);\n      return;\n    }\n\n    this.props.changeDragState({dragStarted: false, dragFrom: null, dragObj: null, dragFromEl: null});\n\n    const prevOrder = dragFrom.order;\n    dragFrom.order = picture.order;\n    picture.order = prevOrder;\n\n  }\n\n  render() {\n    const {picture, isTextOpen} = this.props;\n    return isTextOpen\n      ? <div className='drag_container'\n             imgid={picture.id}>\n        <img className='drag_image'\n             src={picture.src}\n             draggable={false}/>\n      </div>\n      : <div className='drag_container'\n             ref={r => this.dragContainer = r}\n             imgid={picture.id}\n             draggable={true}\n             onDoubleClick={this.props.openDetails}\n             onMouseDown={e => this.onMouseDown(e, picture)}\n             onMouseUp={e => this.onMouseUp(e, picture)}\n             onMouseMove={e => this.onMouseMove(e, picture)}>\n        <img className='drag_image' src={picture.src}/>\n        <CrossIcon className='cross_icon' onClick={this.props.deleteItem}/>\n        <EditIcon className='edit_icon' onClick={this.props.openDetails}/>\n      </div>\n  }\n}\n\nexport default Card;\n\n\n\n// WEBPACK FOOTER //\n// ./components/editAlbum/Card.jsx"],"sourceRoot":""}