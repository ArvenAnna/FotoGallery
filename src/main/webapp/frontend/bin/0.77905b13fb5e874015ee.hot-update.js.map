{"version":3,"sources":["webpack:///./components/editAlbum/EditAlbum.jsx","webpack:///./components/editAlbum/Card.jsx"],"names":["routesModule","require","EditAlbum","connect","store","deleteFotoFromAlbum","React","Component","constructor","props","state","dragStarted","dragFrom","dragFromEl","dragObj","openPicture","album","componentDidMount","http","doGet","routes","GET_ALBUM","match","params","id","then","result","setState","openDetails","picture","onCrossClick","deleteItem","newPictures","images","filter","p","newAlbum","Object","assign","changeDragState","obj","render","sort","x","y","order","map","target","replaceImage","isTextOpen","t","text","Card","replaceEvent","componentWillReceiveProps","dragContainer","replaceAttached","addEventListener","e","attr","getAttribute","pictures","find","changePictureAndClear","onMouseDown","preventDefault","parentElement","clientX","window","scrollX","clientY","scrollY","style","currentStyle","getComputedStyle","elStartLeft","parseInt","left","elStartTop","top","zIndex","onMouseMove","dragState","onMouseUp","event","Event","document","elementFromPoint","dispatchEvent","prevOrder","src","r","name"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMA,eAAe,mBAAAC,CAAQ,GAAR,CAArB;;IAOMC,S,WALL,uFAAAC,CAAQC,UAAU,EAAV,CAAR,EAEG;AACAC,IAAA,uGAAAA;AADA,CAFH,C,gBAKD,MAAMH,SAAN,SAAwB,6CAAAI,CAAMC,SAA9B,CAAwC;;AAEpCC,gBAAYC,KAAZ,EAAmB;AACf,cAAMA,KAAN;AACA,aAAKC,KAAL,GAAa;AACTC,yBAAa,KADJ;AAETC,sBAAU,IAFD;AAGTC,wBAAY,IAHH;AAITC,qBAAS,IAJA;AAKTC,yBAAa,IALJ;AAMTC,mBAAO;AANE,SAAb;AAQH;;AAEDC,wBAAoB;AAChBC,QAAA,6DAAAA,CAAKC,KAAL,CAAWnB,aAAaoB,MAAb,CAAoBC,SAApB,CAA8B,KAAKZ,KAAL,CAAWa,KAAX,CAAiBC,MAAjB,CAAwBC,EAAtD,CAAX,EACKC,IADL,CACUC,UAAU,KAAKC,QAAL,CAAc,EAACX,OAAOU,MAAR,EAAd,CADpB;AAEH;;AAEDE,gBAAYC,OAAZ,EAAqB;AACjB,aAAKF,QAAL,CAAc,EAACZ,aAAac,OAAd,EAAd;AACH;;AAEDC,mBAAe;AACX,aAAKH,QAAL,CAAc,EAACZ,aAAa,IAAd,EAAd;AACH;;AAEDgB,eAAWF,OAAX,EAAoB;AAChB,aAAKpB,KAAL,CAAWJ,mBAAX,CAA+BwB,QAAQL,EAAvC,EAA2C,KAAKd,KAAL,CAAWM,KAAX,CAAiBQ,EAA5D;AACA,cAAMQ,cAAc,KAAKtB,KAAL,CAAWM,KAAX,CAAiBiB,MAAjB,CAAwBC,MAAxB,CAA+BC,KAAKA,EAAEX,EAAF,IAAQK,QAAQL,EAApD,CAApB;AACA,cAAMY,WAAWC,OAAOC,MAAP,CAAc,EAAd,eACV,KAAK5B,KAAL,CAAWM,KADD;AAEbiB,oBAAQD;AAFK,WAAjB;AAIA,aAAKL,QAAL,CAAc,EAACX,OAAOoB,QAAR,EAAd;AACH;;AAEDG,oBAAgBC,GAAhB,EAAqB;AACjB,aAAKb,QAAL,CAAca,GAAd;AACH;;AAEDC,aAAS;AACL,cAAM,EAAC1B,WAAD,EAAaC,KAAb,KAAsB,KAAKN,KAAjC;AACA,eAAOM,SACH;AAAA;AAAA,cAAK,WAAU,gBAAf;AACKA,kBAAMiB,MAAN,CAAaS,IAAb,CAAkB,CAACC,CAAD,EAAGC,CAAH,KAASD,EAAEE,KAAF,GAAQD,EAAEC,KAArC,EAA4CC,GAA5C,CAAgDX,KAAK,4DAAC,sDAAD;AAClD,qBAAKA,EAAEX,EAD2C;AAElD,yBAASW,CAFyC;AAGlD,0BAAUnB,MAAMiB,MAHkC;AAIlD,6BAAa,MAAM,KAAKL,WAAL,EAJ+B;AAKlD,4BAAaO,CAAD,IAAO,KAAKJ,UAAL,CAAgBI,CAAhB,CAL+B;AAMlD,8BAAeY,MAAD,IAAY,KAAKC,YAAL,CAAkBD,MAAlB,CANwB;AAOlD,6BAAahC,WAPqC;AAQlD,iCAAkByB,GAAD,IAAS,KAAKD,eAAL,CAAqBC,GAArB,CARwB;AASlD,2BAAW,KAAK9B;AATkC,cAArD,CADL;AAYI,wEAAC,qEAAD,IAAW,WAAU,WAArB,EAAiC,UAAUuC,UAA3C,EAAuD,OAAM,iBAA7D,GAZJ;AAaKlC,2BACD;AAAA;AAAA,kBAAK,WAAU,UAAf,EAA0B,KAAKmC,KAAK,KAAKC,IAAL,GAAYD,CAAhD;AACI,0FADJ;AAEI,6FAFJ;AAGI,4EAAC,wDAAD,IAAU,WAAU,WAApB,GAHJ;AAII,4EAAC,yDAAD,IAAW,WAAU,YAArB,EAAkC,SAAS,MAAM,KAAKpB,YAAL,EAAjD;AAJJ;AAdJ,SADJ;AAwBH;AAnEmC,C;;;AAsExC,yDAAe5B,SAAf,E;;;;;;;;;;;;;ACrFA;AACA;AACA;;IAEMkD,I,GAAN,MAAMA,IAAN,SAAmB,6CAAA9C,CAAMC,SAAzB,CAAmC;;AAE/BC,gBAAYC,KAAZ,EAAmB;AACf,cAAMA,KAAN;AACA,aAAK4C,YAAL,GAAoB,SAApB;AACH;;AAEDC,gCAA4B;AACxB,YAAI,KAAKC,aAAL,IAAsB,CAAC,KAAKC,eAAhC,EAAiD;AAC7C,iBAAKA,eAAL,GAAuB,IAAvB;AACA,iBAAKD,aAAL,CAAmBE,gBAAnB,CAAoC,KAAKJ,YAAzC,EAAuDK,KAAK,KAAKV,YAAL,CAAkBU,EAAEX,MAApB,CAA5D;AACH;AACJ;;AAEDC,iBAAaD,MAAb,EAAqB;;AAEjB,cAAMY,OAAOZ,OAAOa,YAAP,CAAoB,OAApB,CAAb;AACA,cAAM/B,UAAU,KAAKpB,KAAL,CAAWoD,QAAX,CAAoBC,IAApB,CAAyB3B,KAAKA,EAAEX,EAAF,IAAQmC,IAAtC,CAAhB;;AAEA,aAAKI,qBAAL,CAA2BlC,OAA3B;AACH;;AAEDmC,gBAAYN,CAAZ,EAAe7B,OAAf,EAAwB;AACpB6B,UAAEO,cAAF;;AAEA,cAAMlB,SAASW,EAAEX,MAAF,CAASmB,aAAxB;;AAEA,cAAMvB,IAAIe,EAAES,OAAF,GAAYC,OAAOC,OAA7B;AACA,cAAMzB,IAAIc,EAAEY,OAAF,GAAYF,OAAOG,OAA7B;;AAEA,cAAMC,QAAQzB,OAAO0B,YAAP,IAAuBL,OAAOM,gBAAP,CAAwB3B,MAAxB,CAArC;;AAEA,cAAM4B,cAAcC,SAASJ,MAAMK,IAAf,EAAqB,EAArB,CAApB;AACA,cAAMC,aAAaF,SAASJ,MAAMO,GAAf,EAAoB,EAApB,CAAnB;AACA,cAAMjE,UAAU;AACZ6B,aADY,EACTC,CADS,EACN+B,WADM,EACOG;AADP,SAAhB;AAGA,aAAKrE,KAAL,CAAW8B,eAAX,CAA2B,EAAC5B,aAAa,IAAd,EAAoBC,UAAUiB,OAA9B,EAAuCf,OAAvC,EAAgDD,YAAYkC,MAA5D,EAA3B;AACAA,eAAOyB,KAAP,CAAaQ,MAAb,GAAsB,EAAtB;AACH;;AAEDC,gBAAYvB,CAAZ,EAAe7B,OAAf,EAAwB;AACpB6B,UAAEO,cAAF;AACA,cAAM,EAACrD,QAAD,EAAWD,WAAX,EAAwBG,OAAxB,KAAmC,KAAKL,KAAL,CAAWyE,SAApD;AACA,cAAMnC,SAASW,EAAEX,MAAF,CAASmB,aAAxB;AACA,YAAIvD,eAAeC,YAAYiB,OAA/B,EAAwC;AACpC,kBAAMc,IAAIe,EAAES,OAAF,GAAYC,OAAOC,OAA7B;AACA,kBAAMzB,IAAIc,EAAEY,OAAF,GAAYF,OAAOG,OAA7B;AACAxB,mBAAOyB,KAAP,CAAaO,GAAb,GAAoBjE,QAAQgE,UAAR,GAAqBlC,CAArB,GAAyB9B,QAAQ8B,CAAlC,GAAuC,IAA1D;AACAG,mBAAOyB,KAAP,CAAaK,IAAb,GAAqB/D,QAAQ6D,WAAR,GAAsBhC,CAAtB,GAA0B7B,QAAQ6B,CAAnC,GAAwC,IAA5D;AACH;AACJ;;AAEDwC,cAAUzB,CAAV,EAAa7B,OAAb,EAAsB;AAClB6B,UAAEO,cAAF;;AAEA,cAAM,EAACrD,QAAD,EAAWC,UAAX,KAAyB,KAAKJ,KAAL,CAAWyE,SAA1C;AACA,cAAMnC,SAASW,EAAEX,MAAF,CAASmB,aAAxB;;AAEArD,mBAAW2D,KAAX,CAAiBO,GAAjB,GAAuB,KAAvB;AACAlE,mBAAW2D,KAAX,CAAiBK,IAAjB,GAAwB,KAAxB;;AAEA9B,eAAOyB,KAAP,CAAaO,GAAb,GAAmB,KAAnB;AACAhC,eAAOyB,KAAP,CAAaK,IAAb,GAAoB,KAApB;;AAEAhE,mBAAW2D,KAAX,CAAiBQ,MAAjB,GAA0B,CAA1B;;AAEA,YAAInD,WAAWjB,QAAf,EAAyB;AACrB,kBAAMwE,QAAQ,IAAIC,KAAJ,CAAU,KAAKhC,YAAf,CAAd;AACAiC,qBAASC,gBAAT,CAA0B7B,EAAES,OAAF,GAAYC,OAAOC,OAA7C,EAAsDX,EAAEY,OAAF,GAAYF,OAAOG,OAAzE,EACKL,aADL,CAEKsB,aAFL,CAEmBJ,KAFnB;AAGA;AACH;;AAED,aAAKrB,qBAAL,CAA2BlC,OAA3B;AACH;;AAEDkC,0BAAsBlC,OAAtB,EAA+B;AAC3B,cAAM,EAACjB,QAAD,KAAa,KAAKH,KAAL,CAAWyE,SAA9B;AACA,aAAKzE,KAAL,CAAW8B,eAAX,CAA2B,EAAC5B,aAAa,KAAd,EAAqBC,UAAU,IAA/B,EAAqCE,SAAS,IAA9C,EAAoDD,YAAY,IAAhE,EAA3B;;AAEA,cAAM4E,YAAY7E,SAASiC,KAA3B;AACAjC,iBAASiC,KAAT,GAAiBhB,QAAQgB,KAAzB;AACAhB,gBAAQgB,KAAR,GAAgB4C,SAAhB;AACH;;AAEDhD,aAAS;AACL,cAAM,EAACZ,OAAD,EAAUd,WAAV,KAAyB,KAAKN,KAApC;AACA,eAAOM,cACD;AAAA;AAAA,cAAK,WAAU,gBAAf;AACK,uBAAOc,QAAQL,EADpB;AAEE,iFAAK,WAAU,YAAf;AACK,qBAAKK,QAAQ6D,GADlB;AAEK,2BAAW,KAFhB;AAFF,SADC,GAOD;AAAA;AAAA,cAAK,WAAU,gBAAf;AACK,qBAAKC,KAAK,KAAKpC,aAAL,GAAqBoC,CADpC;AAEK,uBAAO9D,QAAQL,EAFpB;AAGK,2BAAW,IAHhB;AAIK,6BAAakC,KAAK,KAAKM,WAAL,CAAiBN,CAAjB,EAAoB7B,OAApB,CAJvB;AAKK,2BAAW6B,KAAK,KAAKyB,SAAL,CAAezB,CAAf,EAAkB7B,OAAlB,CALrB;AAMK,6BAAa6B,KAAK,KAAKuB,WAAL,CAAiBvB,CAAjB,EAAoB7B,OAApB,CANvB;AAOE,iFAAK,WAAU,YAAf,EAA4B,KAAKA,QAAQ6D,GAAzC,GAPF;AAQE,wEAAC,yDAAD,IAAW,WAAU,YAArB,EAAkC,SAAS,MAAM,KAAKjF,KAAL,CAAWsB,UAAX,CAAsBF,OAAtB,CAAjD,GARF;AASE,wEAAC,wDAAD,IAAU,WAAU,WAApB,EAAgC,SAAS,MAAM,KAAKpB,KAAL,CAAWmB,WAAX,CAAuBC,OAAvB,CAA/C,GATF;AAUE;AAAA;AAAA,kBAAK,WAAU,kBAAf,EAAkC,SAAS,MAAM,KAAKpB,KAAL,CAAWmB,WAAX,CAAuBC,OAAvB,CAAjD;AAAmFA,wBAAQ+D;AAA3F;AAVF,SAPN;AAmBH;AA5G8B,C;;;AA+GnC,yDAAexC,IAAf,E","file":"0.77905b13fb5e874015ee.hot-update.js","sourcesContent":["import React from 'react';\nimport './editAlbum.less';\nimport FileInput from \"../fileInput/FileInput\";\nimport {CrossIcon, SaveIcon} from \"../Icons\";\nimport Card from \"./Card\";\nimport http from '../../HttpService';\nimport connect from \"react-redux/es/connect/connect\";\nimport {deleteFotoFromAlbum} from \"../../actions/albumActions\";\nconst routesModule = require('../../constants/routes');\n\n@connect(store => ({\n\n}), {\n    deleteFotoFromAlbum\n})\nclass EditAlbum extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            dragStarted: false,\n            dragFrom: null,\n            dragFromEl: null,\n            dragObj: null,\n            openPicture: null,\n            album: null\n        }\n    }\n\n    componentDidMount() {\n        http.doGet(routesModule.routes.GET_ALBUM(this.props.match.params.id))\n            .then(result => this.setState({album: result}));\n    }\n\n    openDetails(picture) {\n        this.setState({openPicture: picture});\n    }\n\n    onCrossClick() {\n        this.setState({openPicture: null});\n    }\n\n    deleteItem(picture) {\n        this.props.deleteFotoFromAlbum(picture.id, this.state.album.id);\n        const newPictures = this.state.album.images.filter(p => p.id != picture.id);\n        const newAlbum = Object.assign({}, {\n            ...this.state.album,\n            images: newPictures,\n        })\n        this.setState({album: newAlbum});\n    }\n\n    changeDragState(obj) {\n        this.setState(obj);\n    }\n\n    render() {\n        const {openPicture,album} = this.state;\n        return album && (\n            <div className='edit_container'>\n                {album.images.sort((x,y) => x.order-y.order).map(p => <Card\n                    key={p.id}\n                    picture={p}\n                    pictures={album.images}\n                    openDetails={() => this.openDetails()}\n                    deleteItem={(p) => this.deleteItem(p)}\n                    replaceImage={(target) => this.replaceImage(target)}\n                    openPicture={openPicture}\n                    changeDragState={(obj) => this.changeDragState(obj)}\n                    dragState={this.state}\n                />)}\n                <FileInput className='new_image' disabled={isTextOpen} label='Choose new foto'/>\n                {openPicture &&\n                <div className='new_text' ref={t => this.text = t}>\n                    <input/>\n                    <textarea/>\n                    <SaveIcon className='save_icon'/>\n                    <CrossIcon className='cross_icon' onClick={() => this.onCrossClick()}/>\n                </div>}\n\n            </div>\n        );\n    }\n}\n\nexport default EditAlbum;\n\n\n\n// WEBPACK FOOTER //\n// ./components/editAlbum/EditAlbum.jsx","import React from 'react';\nimport './editAlbum.less';\nimport {CrossIcon, EditIcon} from \"../Icons\";\n\nclass Card extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.replaceEvent = 'replace';\n    }\n\n    componentWillReceiveProps() {\n        if (this.dragContainer && !this.replaceAttached) {\n            this.replaceAttached = true;\n            this.dragContainer.addEventListener(this.replaceEvent, e => this.replaceImage(e.target));\n        }\n    }\n\n    replaceImage(target) {\n\n        const attr = target.getAttribute('imgid');\n        const picture = this.props.pictures.find(p => p.id == attr);\n\n        this.changePictureAndClear(picture);\n    }\n\n    onMouseDown(e, picture) {\n        e.preventDefault();\n\n        const target = e.target.parentElement;\n\n        const x = e.clientX + window.scrollX;\n        const y = e.clientY + window.scrollY;\n\n        const style = target.currentStyle || window.getComputedStyle(target);\n\n        const elStartLeft = parseInt(style.left, 10);\n        const elStartTop = parseInt(style.top, 10);\n        const dragObj = {\n            x, y, elStartLeft, elStartTop\n        }\n        this.props.changeDragState({dragStarted: true, dragFrom: picture, dragObj, dragFromEl: target});\n        target.style.zIndex = 10;\n    }\n\n    onMouseMove(e, picture) {\n        e.preventDefault();\n        const {dragFrom, dragStarted, dragObj} = this.props.dragState;\n        const target = e.target.parentElement;\n        if (dragStarted && dragFrom == picture) {\n            const x = e.clientX + window.scrollX;\n            const y = e.clientY + window.scrollY;\n            target.style.top = (dragObj.elStartTop + y - dragObj.y) + 'px';\n            target.style.left = (dragObj.elStartLeft + x - dragObj.x) + 'px';\n        }\n    }\n\n    onMouseUp(e, picture) {\n        e.preventDefault();\n\n        const {dragFrom, dragFromEl} = this.props.dragState;\n        const target = e.target.parentElement;\n\n        dragFromEl.style.top = '0px';\n        dragFromEl.style.left = '0px';\n\n        target.style.top = '0px';\n        target.style.left = '0px';\n\n        dragFromEl.style.zIndex = 0;\n\n        if (picture == dragFrom) {\n            const event = new Event(this.replaceEvent);\n            document.elementFromPoint(e.clientX + window.scrollX, e.clientY + window.scrollY)\n                .parentElement\n                .dispatchEvent(event);\n            return;\n        }\n\n        this.changePictureAndClear(picture);\n    }\n\n    changePictureAndClear(picture) {\n        const {dragFrom} = this.props.dragState;\n        this.props.changeDragState({dragStarted: false, dragFrom: null, dragObj: null, dragFromEl: null});\n\n        const prevOrder = dragFrom.order;\n        dragFrom.order = picture.order;\n        picture.order = prevOrder;\n    }\n\n    render() {\n        const {picture, openPicture} = this.props;\n        return openPicture\n            ? <div className='drag_container'\n                   imgid={picture.id}>\n                <img className='drag_image'\n                     src={picture.src}\n                     draggable={false}/>\n            </div>\n            : <div className='drag_container'\n                   ref={r => this.dragContainer = r}\n                   imgid={picture.id}\n                   draggable={true}\n                   onMouseDown={e => this.onMouseDown(e, picture)}\n                   onMouseUp={e => this.onMouseUp(e, picture)}\n                   onMouseMove={e => this.onMouseMove(e, picture)}>\n                <img className='drag_image' src={picture.src}/>\n                <CrossIcon className='cross_icon' onClick={() => this.props.deleteItem(picture)}/>\n                <EditIcon className='edit_icon' onClick={() => this.props.openDetails(picture)}/>\n                <div className='text_description' onClick={() => this.props.openDetails(picture)}>{picture.name}</div>\n            </div>\n    }\n}\n\nexport default Card;\n\n\n\n// WEBPACK FOOTER //\n// ./components/editAlbum/Card.jsx"],"sourceRoot":""}