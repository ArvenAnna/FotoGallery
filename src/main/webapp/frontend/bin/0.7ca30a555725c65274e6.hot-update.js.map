{"version":3,"sources":["webpack:///./components/editAlbum/EditAlbum.jsx","webpack:///./components/editAlbum/Card.jsx"],"names":["routesModule","require","EditAlbum","connect","store","deleteFotoFromAlbum","saveFotoDescription","saveAlbumDescription","deleteAlbum","saveItemsOrder","React","Component","constructor","props","state","dragStarted","dragFrom","dragFromEl","dragObj","openPicture","openedAlbum","album","openedDialog","imageDownloaded","componentDidMount","loadAlbum","http","doGet","routes","GET_ALBUM","match","params","id","then","result","images","sort","x","y","order","forEach","image","src","Date","toISOString","setState","openDetails","picture","openAlbumDetails","onCrossClick","deleteItem","length","_id","newPictures","filter","p","newAlbum","Object","assign","removeAlbum","history","push","changeState","obj","editedPicture","find","pinput","value","name","ptextarea","text","editedAlbum","ainput","atextarea","description","uploadFile","file","sendFile","UPLOAD_FOTO","downloadedFoto","isVideo","doPost","FOTO_ROUTE","splitArray","split","format","render","map","target","replaceImage","i","t","Card","replaceEvent","componentWillReceiveProps","dragContainer","replaceAttached","addEventListener","e","attr","getAttribute","pictures","changePictureAndClear","onMouseDown","preventDefault","parentElement","clientX","window","scrollX","clientY","scrollY","style","currentStyle","getComputedStyle","elStartLeft","parseInt","left","elStartTop","top","changeDragState","zIndex","onMouseMove","dragState","onMouseUp","event","Event","document","elementFromPoint","dispatchEvent","dragToPicture","dragFromPicture","prevOrder","updateOrder","r"],"mappings":"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","file":"0.7ca30a555725c65274e6.hot-update.js","sourcesContent":["import React from 'react';\nimport './editAlbum.less';\nimport FileInput from \"../fileInput/FileInput\";\nimport {CrossIcon, SaveIcon} from \"../Icons\";\nimport Card from \"./Card\";\nimport http from '../../HttpService';\nimport connect from \"react-redux/es/connect/connect\";\nimport {\n    deleteAlbum, deleteFotoFromAlbum, saveAlbumDescription,\n    saveFotoDescription, saveItemsOrder\n} from \"../../actions/albumActions\";\nimport Dialog from \"../dialog/Dialog\";\nimport EditCanvas from \"./EditCanvas\";\nconst routesModule = require('../../constants/routes');\n\n@connect(store => ({}), {\n    deleteFotoFromAlbum,\n    saveFotoDescription,\n    saveAlbumDescription,\n    deleteAlbum,\n    saveItemsOrder\n})\nclass EditAlbum extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            dragStarted: false,\n            dragFrom: null,\n            dragFromEl: null,\n            dragObj: null,\n            openPicture: null,\n            openedAlbum: false,\n            album: null,\n            openedDialog: false,\n            imageDownloaded: false\n        }\n    }\n\n    componentDidMount() {\n        this.loadAlbum();\n    }\n\n    loadAlbum() {\n        http.doGet(routesModule.routes.GET_ALBUM(this.props.match.params.id))\n            .then(result => {\n                result.images.sort((x, y) => x.order - y.order);\n                result.images.forEach(image => image.src = image.src + '?forceUpdate=' + new Date().toISOString())\n                this.setState({album: result})\n            });\n    }\n\n    openDetails(picture) {\n        this.setState({openPicture: picture});\n    }\n\n    openAlbumDetails() {\n        this.setState({openedAlbum: true});\n    }\n\n    onCrossClick() {\n        this.setState({openPicture: null, openedAlbum: false});\n    }\n\n    deleteItem(picture) {\n        if (this.state.album.images.length == 1) {\n            this.setState({openedDialog: true});\n            return;\n        }\n\n        this.props.deleteFotoFromAlbum(picture._id);\n        const newPictures = this.state.album.images.filter(p => p._id != picture._id);\n        const newAlbum = Object.assign({}, {\n            ...this.state.album,\n            images: newPictures,\n        })\n        this.setState({album: newAlbum});\n    }\n\n    removeAlbum() {\n        this.props.deleteAlbum(this.state.album._id);\n        this.props.history.push('/');\n    }\n\n    changeState(obj) {\n        this.setState(obj);\n    }\n\n    saveFotoDescription(picture) {\n        const newPictures = [...this.state.album.images];\n        const editedPicture = this.state.album.images.find(p => p._id == picture._id);\n        if (this.pinput.value) editedPicture.name = this.pinput.value;\n        if (this.ptextarea.value) editedPicture.text = this.ptextarea.value;\n\n        this.props.saveFotoDescription(this.state.album._id, editedPicture);\n\n        const newAlbum = Object.assign({}, {\n            ...this.state.album,\n            images: newPictures,\n        });\n        this.setState({album: newAlbum, openPicture: null});\n    }\n\n    saveAlbumDescription() {\n        const editedAlbum = Object.assign({}, {...this.state.album});\n        if (this.ainput.value) editedAlbum.name = this.ainput.value;\n        if (this.atextarea.value) editedAlbum.description = this.atextarea.value;\n\n        this.props.saveAlbumDescription(editedAlbum);\n\n        this.setState({album: editedAlbum, openedAlbum: false});\n    }\n\n    uploadFile(file) {\n        http.sendFile(routesModule.routes.UPLOAD_FOTO, file)\n               .then(downloadedFoto => {\n                   if(this.isVideo(downloadedFoto.src)) {\n                       http.doPost(routesModule.routes.FOTO_ROUTE, {\n                           src: downloadedFoto.src,\n                           album: this.state.album._id\n                       }).then(result => {\n                           const newPictures = [...this.state.album.images];\n                           newPictures.push(result);\n                           const newAlbum = Object.assign({}, {\n                               ...this.state.album,\n                               images: newPictures,\n                           });\n\n                           this.setState({\n                               //imageDownloaded: null,\n                               album: newAlbum\n                           });\n                       });\n                   } else {\n                       this.setState({\n                           imageDownloaded: downloadedFoto.src\n                       });\n                   }\n\n               });\n    }\n\n    isVideo(picture) {\n        let isVideo = false;\n        if (picture) {\n            const splitArray = picture.split('/');\n            let format = splitArray[splitArray.length - 1].split('.');\n            format = format[format.length - 1];\n            isVideo = (format == 'mp4');\n        }\n        return isVideo;\n    }\n\n    render() {\n        const {openPicture, album, openedAlbum, openedDialog, imageDownloaded} = this.state;\n        return album && (\n                    <div className='edit_container'>\n                        <div className='edit_album_card'>\n                            <img className='album_image' src={album.images[0].src}/>\n                            <div className='album_name' onClick={() => this.openAlbumDetails()}>{album.name}</div>\n                            <CrossIcon className='cross_icon' onClick={() => this.setState({openedDialog: true})}/>\n                        </div>\n                        {album.images.sort((x, y) => x.order - y.order).map(p => <Card\n                            key={p._id}\n                            picture={p}\n                            pictures={album.images}\n                            openDetails={(p) => this.openDetails(p)}\n                            deleteItem={(p) => this.deleteItem(p)}\n                            replaceImage={(target) => this.replaceImage(target)}\n                            openPicture={openPicture}\n                            changeDragState={(obj) => this.changeState(obj)}\n                            dragState={this.state}\n                            updateOrder={(album) => this.props.saveItemsOrder(album)}\n                            loadAlbum={() => this.loadAlbum()}\n                            isVideo={(src) => this.isVideo(src)}\n                        />)}\n                        {!imageDownloaded && <FileInput className='new_image'\n                                   disabled={openPicture}\n                                   label='Choose new foto'\n                                   uploadFile={(file) => this.uploadFile(file)}\n                        />}\n                        {imageDownloaded && !this.isVideo(imageDownloaded) && <EditCanvas\n                            image={imageDownloaded}\n                            cleanImage={obj => this.changeState(obj)}\n                            album={album}\n                            />}\n                        {openPicture &&\n                        <div className='new_text'>\n                            <input defaultValue={openPicture.name} ref={i => this.pinput = i}/>\n                            <textarea defaultValue={openPicture.text} ref={t => this.ptextarea = t}/>\n                            <SaveIcon className='save_icon' onClick={() => this.saveFotoDescription(openPicture)}/>\n                            <CrossIcon className='cross_icon' onClick={() => this.onCrossClick()}/>\n                        </div>}\n                        {openedAlbum &&\n                        <div className='new_text'>\n                            <input defaultValue={album.name} ref={i => this.ainput = i}/>\n                            <textarea defaultValue={album.description} ref={t => this.atextarea = t}/>\n                            <SaveIcon className='save_icon' onClick={() => this.saveAlbumDescription()}/>\n                            <CrossIcon className='cross_icon' onClick={() => this.onCrossClick()}/>\n                        </div>}\n                        {openedDialog && <Dialog onClick={() => this.removeAlbum()}\n                        onClose={() => this.setState({openedDialog: false})}\n                                                 text=\"Do you really want to delete the album?\"/>}\n                    </div>\n            );\n    }\n}\n\nexport default EditAlbum;\n\n\n\n// WEBPACK FOOTER //\n// ./components/editAlbum/EditAlbum.jsx","import React from 'react';\nimport './editAlbum.less';\nimport {CrossIcon, EditIcon} from \"../Icons\";\nconst routesModule = require('../../constants/routes');\nimport http from '../../HttpService';\n\nclass Card extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.replaceEvent = 'replace';\n    }\n\n    componentWillReceiveProps() {\n        if (this.dragContainer && !this.replaceAttached) {\n            this.replaceAttached = true;\n            this.dragContainer.addEventListener(this.replaceEvent, e => this.replaceImage(e.target));\n        }\n    }\n\n    replaceImage(target) {\n\n        const attr = target.getAttribute('imgid');\n        const picture = this.props.pictures.find(p => p._id == attr);\n\n        this.changePictureAndClear(picture);\n    }\n\n    onMouseDown(e, picture) {\n        e.preventDefault();\n\n        const target = e.target.parentElement;\n\n        const x = e.clientX + window.scrollX;\n        const y = e.clientY + window.scrollY;\n\n        const style = target.currentStyle || window.getComputedStyle(target);\n\n        const elStartLeft = parseInt(style.left, 10);\n        const elStartTop = parseInt(style.top, 10);\n        const dragObj = {\n            x, y, elStartLeft, elStartTop\n        }\n        this.props.changeDragState({dragStarted: true, dragFrom: picture, dragObj, dragFromEl: target});\n        target.style.zIndex = 10;\n    }\n\n    onMouseMove(e, picture) {\n        e.preventDefault();\n        const {dragFrom, dragStarted, dragObj} = this.props.dragState;\n        const target = e.target.parentElement;\n        if (dragStarted && dragFrom == picture) {\n            const x = e.clientX + window.scrollX;\n            const y = e.clientY + window.scrollY;\n            target.style.top = (dragObj.elStartTop + y - dragObj.y) + 'px';\n            target.style.left = (dragObj.elStartLeft + x - dragObj.x) + 'px';\n        }\n    }\n\n    onMouseUp(e, picture) {\n        e.preventDefault();\n\n        const {dragFrom, dragFromEl} = this.props.dragState;\n        const target = e.target.parentElement;\n\n        dragFromEl.style.top = '0px';\n        dragFromEl.style.left = '0px';\n\n        target.style.top = '0px';\n        target.style.left = '0px';\n\n        dragFromEl.style.zIndex = 0;\n\n        if (picture == dragFrom) {\n            const event = new Event(this.replaceEvent);\n            document.elementFromPoint(e.clientX + window.scrollX, e.clientY + window.scrollY)\n                .parentElement\n                .dispatchEvent(event);\n            return;\n        }\n\n        this.changePictureAndClear(picture);\n    }\n\n    changePictureAndClear(picture) {\n        const {dragFrom, album} = this.props.dragState;\n\n        const newPictures = [...album.images];\n\n        const dragToPicture = album.images.find(p => p._id == picture._id);\n       // editedPicture.order = prevOrder;\n        const dragFromPicture = album.images.find(p => p._id == dragFrom._id);\n\n        const prevOrder = dragFromPicture.order;\n        dragFromPicture.order = dragToPicture.order;\n        dragToPicture.order = prevOrder;\n\n        newPictures.sort((x, y) => x.order - y.order);\n\n        const newAlbum = Object.assign({}, {\n            ...album,\n            images: newPictures,\n        });\n\n        this.props.updateOrder(newAlbum);\n        this.props.changeDragState({dragStarted: false, dragFrom: null, dragObj: null, dragFromEl: null, album: newAlbum});\n    }\n\n    render() {\n        const {picture, openPicture} = this.props;\n        return openPicture\n            ? <div className='drag_container'\n                   imgid={picture._id}>\n                <img className='drag_image'\n                     src={picture.src}\n                     draggable={false}/>\n            </div>\n            : <div className='drag_container'\n                   ref={r => this.dragContainer = r}\n                   imgid={picture._id}\n                   draggable={true}\n                   onMouseDown={e => this.onMouseDown(e, picture)}\n                   onMouseUp={e => this.onMouseUp(e, picture)}\n                   onMouseMove={e => this.onMouseMove(e, picture)}>\n                {this.props.isVideo(picture.src)\n                    ? <video height=\"200\" controls=\"controls\" className='drag_video'>\n                    <source src={picture.src}/>\n                </video>\n                    : <img className='drag_image' src={picture.src}/>}\n                <CrossIcon className='cross_icon' onClick={() => this.props.deleteItem(picture)}/>\n                <EditIcon className='edit_icon' onClick={() => this.props.openDetails(picture)}/>\n                <div className='text_description' onClick={() => this.props.openDetails(picture)}>{picture.name}</div>\n            </div>\n    }\n}\n\nexport default Card;\n\n\n\n// WEBPACK FOOTER //\n// ./components/editAlbum/Card.jsx"],"sourceRoot":""}