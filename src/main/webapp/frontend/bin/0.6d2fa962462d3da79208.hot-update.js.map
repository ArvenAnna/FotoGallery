{"version":3,"sources":["webpack:///./components/editAlbum/EditAlbum.jsx","webpack:///./node_modules/react-avatar-editor/dist/index.js","webpack:///./components/editAlbum/EditCanvas.jsx"],"names":["routesModule","require","EditAlbum","connect","store","deleteFotoFromAlbum","saveFotoDescription","saveAlbumDescription","deleteAlbum","saveItemsOrder","React","Component","constructor","props","state","dragStarted","dragFrom","dragFromEl","dragObj","openPicture","openedAlbum","album","openedDialog","imageDownloaded","componentDidMount","loadAlbum","http","doGet","routes","GET_ALBUM","match","params","id","then","result","images","sort","x","y","order","forEach","image","src","Date","toISOString","setState","openDetails","picture","openAlbumDetails","onCrossClick","deleteItem","length","_id","newPictures","filter","p","newAlbum","Object","assign","removeAlbum","history","push","changeState","obj","editedPicture","find","pinput","value","name","ptextarea","text","editedAlbum","ainput","atextarea","description","uploadFile","file","sendFile","UPLOAD_FOTO","downloadedFoto","render","map","target","replaceImage","i","t","EditCanvas","getEditedImage","avatar","getImage","toBlob","img","split","File","doPost","FOTO_ROUTE","cleanImage","ae","rotateImage"],"mappings":"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","file":"0.6d2fa962462d3da79208.hot-update.js","sourcesContent":["import React from 'react';\nimport './editAlbum.less';\nimport FileInput from \"../fileInput/FileInput\";\nimport {CrossIcon, SaveIcon} from \"../Icons\";\nimport Card from \"./Card\";\nimport http from '../../HttpService';\nimport connect from \"react-redux/es/connect/connect\";\nimport {\n    deleteAlbum, deleteFotoFromAlbum, fetchAlbums, saveAlbumDescription,\n    saveFotoDescription, saveItemsOrder\n} from \"../../actions/albumActions\";\nimport Dialog from \"../dialog/Dialog\";\nimport AvatarEditor from \"react-avatar-editor\";\nimport EditCanvas from \"./EditCanvas\";\nconst routesModule = require('../../constants/routes');\n\n@connect(store => ({}), {\n    deleteFotoFromAlbum,\n    saveFotoDescription,\n    saveAlbumDescription,\n    deleteAlbum,\n   // fetchAlbums,\n    saveItemsOrder\n})\nclass EditAlbum extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            dragStarted: false,\n            dragFrom: null,\n            dragFromEl: null,\n            dragObj: null,\n            openPicture: null,\n            openedAlbum: false,\n            album: null,\n            openedDialog: false,\n            imageDownloaded: false\n        }\n    }\n\n    componentDidMount() {\n        this.loadAlbum();\n    }\n\n    loadAlbum() {\n        http.doGet(routesModule.routes.GET_ALBUM(this.props.match.params.id))\n            .then(result => {\n                result.images.sort((x, y) => x.order - y.order);\n                result.images.forEach(image => image.src = image.src + '?forceUpdate=' + new Date().toISOString())\n                this.setState({album: result})\n            });\n    }\n\n    openDetails(picture) {\n        this.setState({openPicture: picture});\n    }\n\n    openAlbumDetails() {\n        this.setState({openedAlbum: true});\n    }\n\n    onCrossClick() {\n        this.setState({openPicture: null, openedAlbum: false});\n    }\n\n    deleteItem(picture) {\n        if (this.state.album.images.length == 1) {\n            this.setState({openedDialog: true});\n            return;\n        }\n\n        this.props.deleteFotoFromAlbum(picture._id);\n        const newPictures = this.state.album.images.filter(p => p._id != picture._id);\n        const newAlbum = Object.assign({}, {\n            ...this.state.album,\n            images: newPictures,\n        })\n        this.setState({album: newAlbum});\n    }\n\n    removeAlbum() {\n        this.props.deleteAlbum(this.state.album._id);\n        this.props.history.push('/');\n    }\n\n    changeState(obj) {\n        this.setState(obj);\n    }\n\n    saveFotoDescription(picture) {\n        const newPictures = [...this.state.album.images];\n        const editedPicture = this.state.album.images.find(p => p._id == picture._id);\n        if (this.pinput.value) editedPicture.name = this.pinput.value;\n        if (this.ptextarea.value) editedPicture.text = this.ptextarea.value;\n\n        this.props.saveFotoDescription(this.state.album._id, editedPicture);\n\n        const newAlbum = Object.assign({}, {\n            ...this.state.album,\n            images: newPictures,\n        });\n        this.setState({album: newAlbum, openPicture: null});\n    }\n\n    saveAlbumDescription() {\n        const editedAlbum = Object.assign({}, {...this.state.album});\n        if (this.ainput.value) editedAlbum.name = this.ainput.value;\n        if (this.atextarea.value) editedAlbum.description = this.atextarea.value;\n\n        this.props.saveAlbumDescription(editedAlbum);\n\n        this.setState({album: editedAlbum, openedAlbum: false});\n    }\n\n    uploadFile(file) {\n        http.sendFile(routesModule.routes.UPLOAD_FOTO, file)\n               .then(downloadedFoto => {\n                   this.setState({\n                       imageDownloaded: downloadedFoto.src\n                   });\n\n                   // http.doPost(routesModule.routes.FOTO_ROUTE, {\n                   //     src: downloadedFoto.src,\n                   //     album: this.state.album._id\n                   // }).then(result => {\n                   //         const newPictures = [...this.state.album.images];\n                   //         newPictures.push(result);\n                   //         const newAlbum = Object.assign({}, {\n                   //             ...this.state.album,\n                   //             images: newPictures,\n                   //         });\n                   //         this.setState({album: newAlbum});\n                   //         //this.props.fetchAlbums();\n                   //     });\n               });\n    }\n    //\n    // getEditedImage() {\n    //     this.avatar.getImage().toBlob(img => {\n    //         let name = this.state.imageDownloaded.split('/');\n    //         name = path[path.length - 1];\n    //         const file = new File([img], name);\n    //         http.sendFile(routesModule.routes.UPLOAD_FOTO, file)\n    //             .then(downloadedFoto => {\n    //\n    //\n    //             });\n    //     });\n    // }\n\n    render() {\n        const {openPicture, album, openedAlbum, openedDialog, imageDownloaded} = this.state;\n        return album && (\n                    <div className='edit_container'>\n                        <div className='edit_album_card'>\n                            <img className='album_image' src={album.images[0].src}/>\n                            <div className='album_name' onClick={() => this.openAlbumDetails()}>{album.name}</div>\n                            <CrossIcon className='cross_icon' onClick={() => this.setState({openedDialog: true})}/>\n                        </div>\n                        {album.images.sort((x, y) => x.order - y.order).map(p => <Card\n                            key={p._id}\n                            picture={p}\n                            pictures={album.images}\n                            openDetails={(p) => this.openDetails(p)}\n                            deleteItem={(p) => this.deleteItem(p)}\n                            replaceImage={(target) => this.replaceImage(target)}\n                            openPicture={openPicture}\n                            changeDragState={(obj) => this.changeState(obj)}\n                            dragState={this.state}\n                            updateOrder={(album) => this.props.saveItemsOrder(album)}\n                            loadAlbum={() => this.loadAlbum()}\n                        />)}\n                        <FileInput className='new_image'\n                                   disabled={openPicture}\n                                   label='Choose new foto'\n                                   uploadFile={(file) => this.uploadFile(file)}\n                        />\n                        {imageDownloaded && <EditCanvas\n                            image={imageDownloaded}\n                            cleanImage={(obj) => this.changeState(obj)}/>}\n                        {openPicture &&\n                        <div className='new_text'>\n                            <input defaultValue={openPicture.name} ref={i => this.pinput = i}/>\n                            <textarea defaultValue={openPicture.text} ref={t => this.ptextarea = t}/>\n                            <SaveIcon className='save_icon' onClick={() => this.saveFotoDescription(openPicture)}/>\n                            <CrossIcon className='cross_icon' onClick={() => this.onCrossClick()}/>\n                        </div>}\n                        {openedAlbum &&\n                        <div className='new_text'>\n                            <input defaultValue={album.name} ref={i => this.ainput = i}/>\n                            <textarea defaultValue={album.description} ref={t => this.atextarea = t}/>\n                            <SaveIcon className='save_icon' onClick={() => this.saveAlbumDescription()}/>\n                            <CrossIcon className='cross_icon' onClick={() => this.onCrossClick()}/>\n                        </div>}\n                        {openedDialog && <Dialog onClick={() => this.removeAlbum()}\n                        onClose={() => this.setState({openedDialog: false})}\n                                                 text=\"Do you really want to delete the album?\"/>}\n                    </div>\n            );\n    }\n}\n\nexport default EditAlbum;\n\n\n\n// WEBPACK FOOTER //\n// ./components/editAlbum/EditAlbum.jsx","!function(e,t){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=t(require(\"prop-types\"),require(\"react\"),require(\"react-dom\")):\"function\"==typeof define&&define.amd?define([\"prop-types\",\"react\",\"react-dom\"],t):e.AvatarEditor=t(e.PropTypes,e.React,e.ReactDOM)}(this,function(e,t,o){\"use strict\";function a(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}function n(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}function i(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}e=e&&e.hasOwnProperty(\"default\")?e.default:e,t=t&&t.hasOwnProperty(\"default\")?t.default:t,o=o&&o.hasOwnProperty(\"default\")?o.default:o;var r=function(e){var t=\"undefined\"==typeof DOMParser?null:new DOMParser;return t?t.parseFromString(e,\"text/html\"):null},s=function(e,t){for(var o=0;o<e.length;o++){var a=e[o];if(\"text/html\"===a.type){a.getAsString(function(e){var o=r(e).querySelector(\"img\");o&&o.src&&t(o.src)});break}}},h=function(){function e(e,t){var o=[],a=!0,n=!1,i=void 0;try{for(var r,s=e[Symbol.iterator]();!(a=(r=s.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(e){n=!0,i=e}finally{try{!a&&s.return&&s.return()}finally{if(n)throw i}}return o}return function(t,o){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,o);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e},c=function(){function e(e,t){for(var o=0;o<t.length;o++){var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,\"value\"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,o,a){return o&&e(t.prototype,o),a&&e(t,a),t}}(),d=!(\"undefined\"==typeof window||\"undefined\"==typeof navigator||!(\"ontouchstart\"in window||navigator.msMaxTouchPoints>0)),p=\"undefined\"!=typeof File,l={touch:{react:{down:\"onTouchStart\",mouseDown:\"onMouseDown\",drag:\"onTouchMove\",drop:\"onTouchEnd\",move:\"onTouchMove\",mouseMove:\"onMouseMove\",up:\"onTouchEnd\",mouseUp:\"onMouseUp\"},native:{down:\"touchstart\",mouseDown:\"mousedown\",drag:\"touchmove\",drop:\"touchend\",move:\"touchmove\",mouseMove:\"mousemove\",up:\"touchend\",mouseUp:\"mouseup\"}},desktop:{react:{down:\"onMouseDown\",drag:\"onDragOver\",drop:\"onDrop\",move:\"onMouseMove\",up:\"onMouseUp\"},native:{down:\"mousedown\",drag:\"dragStart\",drop:\"drop\",move:\"mousemove\",up:\"mouseup\"}}},g=d?l.touch:l.desktop,m=\"undefined\"!=typeof window&&window.devicePixelRatio?window.devicePixelRatio:1,v=function(e,t,o,a,n,i){if(0===i)e.rect(t,o,a,n);else{var r=a-i,s=n-i;e.translate(t,o),e.arc(i,i,i,Math.PI,1.5*Math.PI),e.lineTo(r,0),e.arc(r,i,i,1.5*Math.PI,2*Math.PI),e.lineTo(a,s),e.arc(r,s,i,2*Math.PI,.5*Math.PI),e.lineTo(i,n),e.arc(i,s,i,.5*Math.PI,Math.PI),e.translate(-t,-o)}},f=function(e){function r(){var e,t,o,i;a(this,r);for(var h=arguments.length,c=Array(h),d=0;d<h;d++)c[d]=arguments[d];return t=o=n(this,(e=r.__proto__||Object.getPrototypeOf(r)).call.apply(e,[this].concat(c))),o.state={drag:!1,my:null,mx:null,image:{x:.5,y:.5}},o.handleMouseDown=function(e){(e=e||window.event).preventDefault(),o.setState({drag:!0,mx:null,my:null})},o.handleMouseUp=function(){o.state.drag&&(o.setState({drag:!1}),o.props.onMouseUp())},o.handleMouseMove=function(e){if(e=e||window.event,!1!==o.state.drag){var t=e.targetTouches?e.targetTouches[0].pageX:e.clientX,a=e.targetTouches?e.targetTouches[0].pageY:e.clientY,n={mx:t,my:a},i=o.props.rotate;if(i%=360,i=i<0?i+360:i,o.state.mx&&o.state.my){var r=o.state.mx-t,s=o.state.my-a,h=o.state.image.width*o.props.scale,c=o.state.image.height*o.props.scale,d=o.getCroppingRect(),p=d.x,l=d.y;p*=h,l*=c;var g=function(e){return e*(Math.PI/180)},m=Math.cos(g(i)),v=Math.sin(g(i)),f=l+-r*v+s*m,y={x:(p+r*m+s*v)/h+1/o.props.scale*o.getXScale()/2,y:f/c+1/o.props.scale*o.getYScale()/2};o.props.onPositionChange(y),n.image=u({},o.state.image,y)}o.setState(n),o.props.onMouseMove(e)}},o.handleDragOver=function(e){(e=e||window.event).preventDefault()},o.handleDrop=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.event;if(e.stopPropagation(),e.preventDefault(),e.dataTransfer){var t=e.dataTransfer,a=t.files,n=t.items;a&&a.length?(o.props.onDropFile(e),o.loadImageFile(a[0])):n&&n.length&&s(n,function(e){return o.loadImage(e)})}},o.setCanvas=function(e){o.canvas=e},i=t,n(o,i)}return i(r,t.Component),c(r,[{key:\"isVertical\",value:function(){return this.props.rotate%180!=0}},{key:\"getBorders\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.border;return Array.isArray(e)?e:[e,e]}},{key:\"getDimensions\",value:function(){var e=this.props,t=e.width,o=e.height,a=e.rotate,n=e.border,i={},r=this.getBorders(n),s=h(r,2),u=s[0],c=s[1],d=t,p=o;return this.isVertical()?(i.width=p,i.height=d):(i.width=d,i.height=p),i.width+=2*u,i.height+=2*c,{canvas:i,rotate:a,width:t,height:o,border:n}}},{key:\"getImage\",value:function(){var e=this.getCroppingRect(),t=this.state.image;e.x*=t.resource.width,e.y*=t.resource.height,e.width*=t.resource.width,e.height*=t.resource.height;var o=document.createElement(\"canvas\");this.isVertical()?(o.width=e.height,o.height=e.width):(o.width=e.width,o.height=e.height);var a=o.getContext(\"2d\");return a.translate(o.width/2,o.height/2),a.rotate(this.props.rotate*Math.PI/180),a.translate(-o.width/2,-o.height/2),this.isVertical()&&a.translate((o.width-o.height)/2,(o.height-o.width)/2),a.drawImage(t.resource,-e.x,-e.y),o}},{key:\"getImageScaledToCanvas\",value:function(){var e=this.getDimensions(),t=e.width,o=e.height,a=document.createElement(\"canvas\");return this.isVertical()?(a.width=o,a.height=t):(a.width=t,a.height=o),this.paintImage(a.getContext(\"2d\"),this.state.image,0,1),a}},{key:\"getXScale\",value:function(){var e=this.props.width/this.props.height,t=this.state.image.width/this.state.image.height;return Math.min(1,e/t)}},{key:\"getYScale\",value:function(){var e=this.props.height/this.props.width,t=this.state.image.height/this.state.image.width;return Math.min(1,e/t)}},{key:\"getCroppingRect\",value:function(){var e=this.props.position||{x:this.state.image.x,y:this.state.image.y},t=1/this.props.scale*this.getXScale(),o=1/this.props.scale*this.getYScale(),a={x:e.x-t/2,y:e.y-o/2,width:t,height:o},n=0,i=1-a.width,r=0,s=1-a.height;return(t>1||o>1)&&(n=-a.width,i=1,r=-a.height,s=1),u({},a,{x:Math.max(n,Math.min(a.x,i)),y:Math.max(r,Math.min(a.y,s))})}},{key:\"isDataURL\",value:function(e){if(null===e)return!1;var t=/^\\s*data:([a-z]+\\/[a-z]+(;[a-z-]+=[a-z-]+)?)?(;base64)?,[a-z0-9!$&',()*+;=\\-._~:@/?%\\s]*\\s*$/i;return!!e.match(t)}},{key:\"loadImage\",value:function(e){p&&e instanceof File?this.loadImageFile(e):\"string\"==typeof e&&this.loadImageURL(e)}},{key:\"loadImageURL\",value:function(e){var t=new Image;t.onload=this.handleImageReady.bind(this,t),t.onerror=this.props.onLoadFailure,!this.isDataURL(e)&&this.props.crossOrigin&&(t.crossOrigin=this.props.crossOrigin),t.src=e}},{key:\"loadImageFile\",value:function(e){var t=this,o=new FileReader;o.onload=function(e){return t.loadImageURL(e.target.result)},o.readAsDataURL(e)}},{key:\"componentDidMount\",value:function(){var e=o.findDOMNode(this.canvas).getContext(\"2d\");if(this.props.image&&this.loadImage(this.props.image),this.paint(e),document){var t=g.native;document.addEventListener(t.move,this.handleMouseMove,!1),document.addEventListener(t.up,this.handleMouseUp,!1),d&&(document.addEventListener(t.mouseMove,this.handleMouseMove,!1),document.addEventListener(t.mouseUp,this.handleMouseUp,!1))}}},{key:\"componentWillUnmount\",value:function(){if(document){var e=g.native;document.removeEventListener(e.move,this.handleMouseMove,!1),document.removeEventListener(e.up,this.handleMouseUp,!1),d&&(document.removeEventListener(e.mouseMove,this.handleMouseMove,!1),document.removeEventListener(e.mouseUp,this.handleMouseUp,!1))}}},{key:\"componentDidUpdate\",value:function(e,t){var a=o.findDOMNode(this.canvas),n=a.getContext(\"2d\");n.clearRect(0,0,a.width,a.height),this.paint(n),this.paintImage(n,this.state.image,this.props.border),e.image===this.props.image&&e.width===this.props.width&&e.height===this.props.height&&e.position===this.props.position&&e.scale===this.props.scale&&e.rotate===this.props.rotate&&t.my===this.state.my&&t.mx===this.state.mx&&t.image.x===this.state.image.x&&t.image.y===this.state.image.y||this.props.onImageChange()}},{key:\"handleImageReady\",value:function(e){var t=this.getInitialSize(e.width,e.height);t.resource=e,t.x=.5,t.y=.5,this.setState({drag:!1,image:t},this.props.onImageReady),this.props.onLoadSuccess(t)}},{key:\"getInitialSize\",value:function(e,t){var o=void 0,a=void 0,n=this.getDimensions();return n.height/n.width>t/e?a=e*((o=this.getDimensions().height)/t):o=t*((a=this.getDimensions().width)/e),{height:o,width:a}}},{key:\"componentWillReceiveProps\",value:function(e){(e.image&&this.props.image!==e.image||this.props.width!==e.width||this.props.height!==e.height)&&this.loadImage(e.image)}},{key:\"paintImage\",value:function(e,t,o){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:m;if(t.resource){var n=this.calculatePosition(t,o);e.save(),e.translate(e.canvas.width/2,e.canvas.height/2),e.rotate(this.props.rotate*Math.PI/180),e.translate(-e.canvas.width/2,-e.canvas.height/2),this.isVertical()&&e.translate((e.canvas.width-e.canvas.height)/2,(e.canvas.height-e.canvas.width)/2),e.scale(a,a),e.globalCompositeOperation=\"destination-over\",e.drawImage(t.resource,n.x,n.y,n.width,n.height),e.restore()}}},{key:\"calculatePosition\",value:function(e,t){e=e||this.state.image;var o=this.getBorders(t),a=h(o,2),n=a[0],i=a[1],r=this.getCroppingRect(),s=e.width*this.props.scale,u=e.height*this.props.scale,c=-r.x*s,d=-r.y*u;return this.isVertical()?(c+=i,d+=n):(c+=n,d+=i),{x:c,y:d,height:u,width:s}}},{key:\"paint\",value:function(e){e.save(),e.scale(m,m),e.translate(0,0),e.fillStyle=\"rgba(\"+this.props.color.slice(0,4).join(\",\")+\")\";var t=this.props.borderRadius,o=this.getDimensions(),a=this.getBorders(o.border),n=h(a,2),i=n[0],r=n[1],s=o.canvas.height,u=o.canvas.width;t=Math.max(t,0),t=Math.min(t,u/2-i,s/2-r),e.beginPath(),v(e,i,r,u-2*i,s-2*r,t),e.rect(u,0,-u,s),e.fill(\"evenodd\"),e.restore()}},{key:\"render\",value:function(){var e=this.getDimensions(),o={width:e.canvas.width,height:e.canvas.height,cursor:this.state.drag?\"grabbing\":\"grab\"},a={width:e.canvas.width*m,height:e.canvas.height*m,style:u({},o,this.props.style)};return a[g.react.down]=this.handleMouseDown,a[g.react.drag]=this.handleDragOver,this.props.disableDrop||(a[g.react.drop]=this.handleDrop),d&&(a[g.react.mouseDown]=this.handleMouseDown),t.createElement(\"canvas\",u({ref:this.setCanvas},a))}}]),r}();return f.propTypes={scale:e.number,rotate:e.number,image:e.oneOfType([e.string].concat(function(e){if(Array.isArray(e)){for(var t=0,o=Array(e.length);t<e.length;t++)o[t]=e[t];return o}return Array.from(e)}(p?[e.instanceOf(File)]:[]))),border:e.oneOfType([e.number,e.arrayOf(e.number)]),borderRadius:e.number,width:e.number,height:e.number,position:e.shape({x:e.number,y:e.number}),color:e.arrayOf(e.number),style:e.object,crossOrigin:e.oneOf([\"\",\"anonymous\",\"use-credentials\"]),onDropFile:e.func,onLoadFailure:e.func,onLoadSuccess:e.func,onImageReady:e.func,onImageChange:e.func,onMouseUp:e.func,onMouseMove:e.func,onPositionChange:e.func,disableDrop:e.bool},f.defaultProps={disableDrop:!1,scale:1,rotate:0,border:25,borderRadius:0,width:200,height:200,color:[0,0,0,.5],style:{},onDropFile:function(){},onLoadFailure:function(){},onLoadSuccess:function(){},onImageReady:function(){},onImageChange:function(){},onMouseUp:function(){},onMouseMove:function(){},onPositionChange:function(){}},f});\n//# sourceMappingURL=index.js.map\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/react-avatar-editor/dist/index.js\n// module id = 193\n// module chunks = 0","import React from 'react';\nimport './editAlbum.less';\nimport {CrossIcon, EditIcon, RotateIcon} from \"../Icons\";\nimport AvatarEditor from \"react-avatar-editor\";\nconst routesModule = require('../../constants/routes');\nimport http from '../../HttpService';\n\nclass EditCanvas extends React.Component {\n\n    // constructor(props) {\n    //     super(props);\n    // }\n\n    getEditedImage() {\n        this.avatar.getImage().toBlob(img => {\n            let name = this.props.image.split('/');\n            name = name[name.length - 1];\n            const file = new File([img], name);\n\n            http.sendFile(routesModule.routes.UPLOAD_FOTO, file)\n                .then(downloadedFoto => {\n                    http.doPost(routesModule.routes.FOTO_ROUTE, {\n                        src: downloadedFoto.src,\n                        album: this.state.album._id\n                    }).then(result => {\n                            const newPictures = [...this.state.album.images];\n                            newPictures.push(result);\n                            const newAlbum = Object.assign({}, {\n                                ...this.state.album,\n                                images: newPictures,\n                            });\n\n                            this.props.cleanImage({\n                                imageDownloaded: null,\n                                album: newAlbum\n                            });\n                        });\n                });\n        });\n    }\n\n    render() {\n        const {image} = this.props;\n        return <div>\n            <AvatarEditor\n            ref={ae => this.avatar = ae}\n            image={image}\n            rotate={0}\n        />\n            <RotateIcon className='rotate_icon' onClick={() => this.rotateImage()}/>\n            <button onClick={() => this.getEditedImage()}>save</button></div>\n    }\n}\n\nexport default EditCanvas;\n\n\n\n// WEBPACK FOOTER //\n// ./components/editAlbum/EditCanvas.jsx"],"sourceRoot":""}