{"version":3,"sources":["webpack:///./components/picture/Picture.jsx"],"names":["Picture","React","Component","constructor","props","state","magnify","valid","loading","click","setState","animation","closePreview","mouseLeave","e","chooseAnimation","mouseEnter","fade","move","findSide","direction","clientRect","target","getClientRects","diffs","side","diff","Math","abs","clientX","left","right","clientY","top","bottom","minDiff","min","Array","from","el","find","handleBrokenImg","onLoad","render","album","main","images","isVideo","src","name","_id"],"mappings":"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","file":"0.93bca36cef4d4caec9e9.hot-update.js","sourcesContent":["import React from \"react\";\nimport {MagnifierIcon} from \"../Icons\";\nimport \"./picture.less\";\nimport Preview from \"./Preview\";\nimport {isVideo} from \"../../utils/index\";\nimport * as styles from \"../../constants/styles\";\nimport 'loaders.css/src/animations/ball-scale-multiple.scss';\n\n\nclass Picture extends React.Component {\n    // animation: fade, move\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            magnify: '',\n            valid: true,\n            loading: true\n        };\n    }\n\n    click() {\n        this.setState({\n            magnify: 'magnify',\n            animation: ''\n        });\n    };\n\n    closePreview() {\n        this.setState({\n            magnify: ''\n        });\n    }\n\n    mouseLeave(e) {\n        !this.state.magnify && this.chooseAnimation(e, 'fade_out', 'from');\n    };\n\n    mouseEnter(e) {\n        !this.state.magnify && this.chooseAnimation(e, 'fade_in', 'to');\n    };\n\n    chooseAnimation(e, fade, move) {\n        switch (this.props.animation) {\n            case 'fade':\n                this.setState({\n                    animation: fade\n                });\n                break;\n            case 'move':\n                this.setState({\n                    animation: this.findSide(e, move)\n                });\n        }\n    }\n\n    findSide(e, direction) {\n        const clientRect = e.target.getClientRects()[0];\n        const diffs = [\n            {\n                side: `move_${direction}_right`,\n                diff: Math.abs(e.clientX - clientRect.left)\n            }, {\n                side: `move_${direction}_left`,\n                diff: Math.abs(e.clientX - clientRect.right)\n            }, {\n                side: `move_${direction}_bottom`,\n                diff: Math.abs(e.clientY - clientRect.top)\n            }, {\n                side: `move_${direction}_top`,\n                diff: Math.abs(e.clientY - clientRect.bottom)\n            }\n        ];\n\n        const minDiff = Math.min(...Array.from(diffs, el => el.diff));\n        return diffs.find(el => el.diff == minDiff).side;\n    }\n\n    handleBrokenImg(e) {\n        this.setState({\n            valid: false\n        })\n    }\n\n    onLoad() {\n        this.setState({loading: false});\n    }\n\n    render() {\n        const {album} = this.props;\n        const main = album.images[0];\n        const {animation, magnify, loading} = this.state;\n        if (loading) return <Loader type=\"ball-scale-multiple\"/>;\n        \n        return this.state.valid && <div className=\"image_main_wrapper\">\n                <div\n                    className={`image_wrapper ${animation} ${magnify}`}\n                    onMouseLeave={(e) => this.mouseLeave(e)}\n                    onMouseEnter={(e) => this.mouseEnter(e)}\n                    onClick={(e) => this.click(e)}\n                >\n                    {isVideo(main.src)\n                        ? <video height={styles.picture_height}\n                                 width={styles.picture_width}\n                                 onLoad={() => this.onLoad()}\n                                 controls=\"controls\"\n                                 className=\"video\">\n                        <source src={main.src}/>\n                    </video>\n                        : <img className='image'\n                         onError={(e) => this.handleBrokenImg(e)}\n                         onLoad={() => this.onLoad()}\n                         src={main.src}\n                         alt=\"something wrong happens\"/>}\n                    <div className={'overlay'}>\n                        <div className={`overlay_top`}>\n                            <MagnifierIcon/>\n                        </div>\n                        <div className={`overlay_bottom`}>\n                            <div className='overlay_bottom_text'>{album.name}</div>\n                        </div>\n                    </div>\n                </div>\n                {magnify && [<div key=\"preview_overlay\" className=\"preview_overlay\"/>,\n                <Preview main={main}\n                         key=\"preview\"\n                         close={() => this.closePreview()}\n                         editRoute={`/edit/${album._id}`}\n                         images={album.images}/>]}\n            </div>;\n    }\n}\n\nexport default Picture;\n\n\n// WEBPACK FOOTER //\n// ./components/picture/Picture.jsx"],"sourceRoot":""}