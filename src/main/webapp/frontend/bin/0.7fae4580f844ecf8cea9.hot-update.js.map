{"version":3,"sources":["webpack:///./components/picture/PreviewImageFrame.jsx"],"names":["PreviewImageFrame","React","Component","constructor","props","img","current","images","find","src","main","currentIndex","indexOf","state","imageWidth","left","right","length","index","componentDidMount","containerStyle","cont","currentStyle","window","getComputedStyle","height","addEventListener","changeImageWidth","animationTime","parseInt","constants","setTimeout","componentWillUnmount","removeEventListener","getImageContainerWidth","imageRect","getBoundingClientRect","width","onLoad","e","console","dir","target","log","naturalWidth","naturalHeight","newImages","setState","setImageWidth","onCrossClick","close","onArrowClick","arrow","clearAnimate","render","editRoute","isVideo","node"],"mappings":";;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;;IAEMA,iB,GAAN,MAAMA,iBAAN,SAAgC,6CAAAC,CAAMC,SAAtC,CAAgD;;AAE9CC,cAAYC,KAAZ,EAAmB;AACjB,UAAMA,KAAN;;AAEA,SAAKC,GAAL,GAAW,IAAX;;AAEA,UAAMC,UAAUF,MAAMG,MAAN,CAAaC,IAAb,CAAkBH,OAAOA,IAAII,GAAJ,KAAYL,MAAMM,IAAN,CAAWD,GAAhD,CAAhB;AACA,UAAME,eAAeP,MAAMG,MAAN,CAAaK,OAAb,CAAqBN,OAArB,CAArB;;AAEA,SAAKO,KAAL,GAAa;AACXC,kBAAY,CADD;AAEXJ,YAAMN,MAAMM,IAFD;AAGXK,YAAMJ,eAAe,CAHV;AAIXK,aAAOL,eAAgBP,MAAMG,MAAN,CAAaU,MAAb,GAAsB,CAJlC;AAKTV,cAAQH,MAAMG,MALL;AAMTW,aAAOP;AANE,KAAb;AAQD;;AAEDQ,sBAAoB;AAClB,UAAMC,iBAAiB,KAAKC,IAAL,CAAUC,YAAV,IAA0BC,OAAOC,gBAAP,CAAwB,KAAKH,IAA7B,CAAjD;AACA,SAAKI,MAAL,GAAcL,eAAeK,MAA7B;AACA;AACAF,WAAOG,gBAAP,CAAwB,QAAxB,EAAkC,MAAM,KAAKC,gBAAL,EAAxC;AACA,UAAMC,gBAAgBC,SAAS,yDAAAC,CAAU,4BAAV,CAAT,CAAtB;AACAP,WAAOQ,UAAP,CAAkB,MAAM,KAAKJ,gBAAL,EAAxB,EAAiDC,gBAAc,IAAd,GAAqB,EAAtE;AACD;;AAEDI,yBAAuB;AACrBT,WAAOU,mBAAP,CAA2B,QAA3B,EAAqC,MAAM,KAAKN,gBAAL,EAA3C;AACD;;AAEDO,2BAAyB;AACvB,UAAM7B,MAAM,KAAKA,GAAjB;AACA,QAAI,CAACA,GAAL,EAAU,OAAO,CAAP;AACV,UAAM8B,YAAY9B,IAAI+B,qBAAJ,EAAlB;AACA,WAAOD,UAAUE,KAAjB;AACD;;AAEDC,SAAOC,CAAP,EAAU;AACR;AACAC,YAAQC,GAAR,CAAYF,EAAEG,MAAd;AACAF,YAAQG,GAAR,CAAYJ,EAAEG,MAAF,CAASL,KAArB;AACA,UAAMA,QAAQE,EAAEG,MAAF,CAASE,YAAT,GAAwB,KAAKnB,MAA7B,GAAsCc,EAAEG,MAAF,CAASG,aAA7D;AACA,QAAIC,YAAY,CAAC,GAAG,KAAKjC,KAAL,CAAWN,MAAf,CAAhB;AACAuC,cAAU,KAAKjC,KAAL,CAAWK,KAArB,EAA4BmB,KAA5B,GAAoCA,KAApC;AACA,SAAKU,QAAL,CAAc,EAACxC,QAAQuC,SAAT,EAAd;AACA;AACA,SAAK1C,KAAL,CAAW4C,aAAX,CAAyBX,KAAzB;AACD;;AAEDY,iBAAe;AACb,SAAK7C,KAAL,CAAW8C,KAAX;AACD;;AAEDC,eAAaC,KAAb,EAAoB;AAClB,UAAM,EAAC7C,MAAD,KAAW,KAAKH,KAAtB;AACA;AACA,UAAMO,eAAeJ,OAAOK,OAAP,CAAe,KAAKC,KAAL,CAAWH,IAA1B,CAArB;AACA,QAAIA,IAAJ;;AAEA,QAAI0C,UAAU,MAAV,IAAoBzC,eAAe,CAAvC,EAA0C;AACxCD,aAAOH,OAAOI,eAAe,CAAtB,CAAP;AACA,WAAKoC,QAAL,CAAc;AACZrC,YADY;AAEZK,cAAOJ,eAAe,CAAhB,GAAqB,CAFf;AAGZK,eAAQL,eAAe,CAAhB,GAAsBJ,OAAOU,MAAP,GAAgB,CAHjC;AAIZC,eAAOP,eAAe;AAJV,OAAd;AAMD;;AAED,QAAIyC,UAAU,OAAV,IAAqBzC,eAAgBJ,OAAOU,MAAP,GAAgB,CAAzD,EAA6D;AACzDP,aAAOH,OAAOI,eAAe,CAAtB,CAAP;AACA,WAAKoC,QAAL,CAAc;AACdrC,YADc;AAEdK,cAAOJ,eAAe,CAAhB,GAAqB,CAFb;AAGdK,eAAQL,eAAe,CAAhB,GAAsBJ,OAAOU,MAAP,GAAgB,CAH/B;AAIdC,eAAOP,eAAe;AAJR,OAAd;AAMH;;AAED,SAAKP,KAAL,CAAWiD,YAAX,CAAwB3C,IAAxB;AACD;;AAED4C,WAAS;AACP,UAAM,EAAC5C,IAAD,EAAOK,IAAP,EAAaC,KAAb,KAAsB,KAAKH,KAAjC;AACA,UAAM,EAACN,MAAD,EAASgD,SAAT,KAAsB,KAAKnD,KAAjC;;AAEA,WAAQ;AAAA;AAAA,QAAK,WAAU,mCAAf,EAAmD,KAAKiB,QAAQ,KAAKA,IAAL,GAAYA,IAA5E;AACJ,kEAAC,yDAAD,IAAW,WAAU,OAArB,EAA6B,SAAS,MAAM,KAAK4B,YAAL,EAA5C,GADI;AAECM,mBAAa;AAAC,sEAAD;AAAA,UAAM,IAAI,KAAKnD,KAAL,CAAWmD,SAArB;AAAgC,oEAAC,wDAAD,IAAU,WAAU,MAApB;AAAhC,OAFd;AAGHxC,cAAQ;AAAA;AAAA,UAAK,WAAU,YAAf;AACP,oEAAC,6DAAD,IAAe,SAAS,MAAM,KAAKoC,YAAL,CAAkB,MAAlB,CAA9B;AADO,OAHL;AAMHnC,eAAS;AAAA;AAAA,UAAK,WAAU,aAAf;AACR,oEAAC,8DAAD,IAAgB,SAAS,MAAM,KAAKmC,YAAL,CAAkB,OAAlB,CAA/B;AADQ,OANN;AASJ;AAAA;AAAA,UAAK,WAAU,mBAAf;AACE;AAAA;AAAA,YAAK,WAAU,SAAf;AAA2B,aAAG5C,OAAOK,OAAP,CAAeF,IAAf,IAAuB,CAAG,OAAMH,OAAOU,MAAO;AAA5E;AADF,OATI;AAYHuC,MAAA,qEAAAA,CAAQ9C,KAAKD,GAAb,IACK;AAAA;AAAA,UAAO,UAAS,UAAhB;AACO,eAAKgD,QAAQ,KAAKpD,GAAL,GAAWoD,IAD/B;AAEO,kBAASlB,CAAD,IAAO,KAAKD,MAAL,CAAYC,CAAZ,CAFtB;AAGO,qBAAU;AAHjB;AAKA,gFAAQ,KAAK7B,KAAKD,GAAlB;AALA,OADL,GAQI,qEAAK,QAAS8B,CAAD,IAAO,KAAKD,MAAL,CAAYC,CAAZ,CAApB;AACK,aAAK7B,KAAKD,GADf,EACoB,WAAU,eAD9B;AAEK,aAAKgD,QAAQ,KAAKpD,GAAL,GAAWoD,IAF7B;AApBD,KAAR;AAyBD;AAlH6C,C;;;AAqHhD,yDAAezD,iBAAf,E","file":"0.7fae4580f844ecf8cea9.hot-update.js","sourcesContent":["import React from \"react\";\nimport {CrossIcon, EditIcon, LeftArrowIcon, RightArrowIcon} from \"../Icons\";\nimport \"./preview.less\";\nimport {Link} from \"react-router-dom\";\nimport {isVideo} from \"../../utils/index\";\nimport constants from '../../constants/styles';\n\nclass PreviewImageFrame extends React.Component {\n\n  constructor(props) {\n    super(props);\n\n    this.img = null;\n\n    const current = props.images.find(img => img.src === props.main.src);\n    const currentIndex = props.images.indexOf(current);\n\n    this.state = {\n      imageWidth: 0,\n      main: props.main,\n      left: currentIndex > 0,\n      right: currentIndex < (props.images.length - 1),\n        images: props.images,\n        index: currentIndex\n    };\n  }\n\n  componentDidMount() {\n    const containerStyle = this.cont.currentStyle || window.getComputedStyle(this.cont);\n    this.height = containerStyle.height;\n    //this.changeImageWidth();\n    window.addEventListener('resize', () => this.changeImageWidth());\n    const animationTime = parseInt(constants['preview_animation_duration']);\n    window.setTimeout(() => this.changeImageWidth(), animationTime*1000 + 50)\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', () => this.changeImageWidth());\n  }\n\n  getImageContainerWidth() {\n    const img = this.img;\n    if (!img) return 0;\n    const imageRect = img.getBoundingClientRect();\n    return imageRect.width;\n  }\n\n  onLoad(e) {\n    //onload\n    console.dir(e.target);\n    console.log(e.target.width);\n    const width = e.target.naturalWidth * this.height / e.target.naturalHeight;\n    let newImages = [...this.state.images];\n    newImages[this.state.index].width = width;\n    this.setState({images: newImages});\n    // zapisat v img obj picture\n    this.props.setImageWidth(width);\n  }\n\n  onCrossClick() {\n    this.props.close();\n  }\n\n  onArrowClick(arrow) {\n    const {images} = this.props;\n    //const current = images.find(img => img === this.state.main);\n    const currentIndex = images.indexOf(this.state.main);\n    let main;\n\n    if (arrow === 'left' && currentIndex > 0) {\n      main = images[currentIndex - 1];\n      this.setState({\n        main,\n        left: (currentIndex - 1) > 0,\n        right: (currentIndex - 1) < (images.length - 1),\n        index: currentIndex - 1\n      });\n    }\n\n    if (arrow === 'right' && currentIndex < (images.length - 1)) {\n        main = images[currentIndex + 1];\n        this.setState({\n        main,\n        left: (currentIndex + 1) > 0,\n        right: (currentIndex + 1) < (images.length - 1),\n        index: currentIndex + 1\n      })\n    }\n\n    this.props.clearAnimate(main);\n  }\n\n  render() {\n    const {main, left, right} = this.state;\n    const {images, editRoute} = this.props;\n\n    return (<div className='magnify_modal_img_frame_container' ref={cont => this.cont = cont}>\n        <CrossIcon className='cross' onClick={() => this.onCrossClick()}/>\n            {editRoute && <Link to={this.props.editRoute}><EditIcon className='edit'/></Link>}\n        {left && <div className='left_arrow'>\n          <LeftArrowIcon onClick={() => this.onArrowClick('left')}/>\n        </div>}\n        {right && <div className='right_arrow'>\n          <RightArrowIcon onClick={() => this.onArrowClick('right')}/>\n        </div>}\n        <div className='counter_container'>\n          <div className='counter'>{`${(images.indexOf(main) + 1)} of ${images.length}`}</div>\n        </div>\n        {isVideo(main.src)\n            ? <video controls=\"controls\"\n                     ref={node => this.img = node}\n                     onLoad={(e) => this.onLoad(e)}\n                     className=\"image_preview\"\n                     >\n              <source src={main.src}/>\n            </video>\n            :<img onLoad={(e) => this.onLoad(e)}\n                  src={main.src} className='image_preview'\n                  ref={node => this.img = node}/>}\n      </div>\n    );\n  }\n}\n\nexport default PreviewImageFrame;\n\n\n// WEBPACK FOOTER //\n// ./components/picture/PreviewImageFrame.jsx"],"sourceRoot":""}