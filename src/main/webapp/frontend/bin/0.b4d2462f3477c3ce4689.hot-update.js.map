{"version":3,"sources":["webpack:///./components/picture/Picture.jsx"],"names":["Picture","React","Component","constructor","props","imageLoadStarted","state","magnify","valid","loading","click","setState","animation","closePreview","mouseLeave","e","chooseAnimation","mouseEnter","fade","move","findSide","direction","clientRect","target","getClientRects","diffs","side","diff","Math","abs","clientX","left","right","clientY","top","bottom","minDiff","min","Array","from","el","find","handleBrokenImg","Alert","error","album","images","name","onLoad","loadImage","url","image","Image","onload","bind","onerror","src","render","main","isVideo","_id"],"mappings":"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","file":"0.b4d2462f3477c3ce4689.hot-update.js","sourcesContent":["import React from \"react\";\nimport {MagnifierIcon} from \"../Icons\";\nimport \"./picture.less\";\nimport Preview from \"./Preview\";\nimport {isVideo} from \"../../utils/index\";\nimport Loader from 'react-loaders';\nimport * as styles from \"../../constants/styles\";\nimport 'loaders.css/src/animations/ball-scale-multiple.scss';\nimport Alert from 'react-s-alert';\n\nclass Picture extends React.Component {\n    // animation: fade, move\n\n    constructor(props) {\n        super(props);\n        this.imageLoadStarted = false;\n\n        this.state = {\n            magnify: '',\n            valid: true,\n            loading: true,\n        };\n    }\n\n    click() {\n        this.setState({\n            magnify: 'magnify',\n            animation: ''\n        });\n    };\n\n    closePreview() {\n        this.setState({\n            magnify: ''\n        });\n    }\n\n    mouseLeave(e) {\n        !this.state.magnify && this.chooseAnimation(e, 'fade_out', 'from');\n    };\n\n    mouseEnter(e) {\n        !this.state.magnify && this.chooseAnimation(e, 'fade_in', 'to');\n    };\n\n    chooseAnimation(e, fade, move) {\n        switch (this.props.animation) {\n            case 'fade':\n                this.setState({\n                    animation: fade\n                });\n                break;\n            case 'move':\n                this.setState({\n                    animation: this.findSide(e, move)\n                });\n        }\n    }\n\n    findSide(e, direction) {\n        const clientRect = e.target.getClientRects()[0];\n        const diffs = [\n            {\n                side: `move_${direction}_right`,\n                diff: Math.abs(e.clientX - clientRect.left)\n            }, {\n                side: `move_${direction}_left`,\n                diff: Math.abs(e.clientX - clientRect.right)\n            }, {\n                side: `move_${direction}_bottom`,\n                diff: Math.abs(e.clientY - clientRect.top)\n            }, {\n                side: `move_${direction}_top`,\n                diff: Math.abs(e.clientY - clientRect.bottom)\n            }\n        ];\n\n        const minDiff = Math.min(...Array.from(diffs, el => el.diff));\n        return diffs.find(el => el.diff == minDiff).side;\n    }\n\n    handleBrokenImg() {\n        Alert.error(\"Image for name {\" + this.props.album.images[0].name + \"} loading failed\", {});\n        this.imageLoadStarted = true;\n        this.setState({\n            loading: false,\n            valid: false\n        })\n    }\n\n    onLoad() {\n        this.imageLoadStarted = true;\n        this.setState({loading: false});\n    }\n\n    loadImage(url) {\n        let image = new Image();\n        image.onload = this.onLoad.bind(this);\n        image.onerror = this.handleBrokenImg.bind(this);\n        image.src = url;\n    }\n\n    render() {\n        const {album} = this.props;\n        const main = album.images[0];\n        const {animation, magnify, loading} = this.state;\n        if (!this.imageLoadStarted) this.loadImage(main.src);\n\n        return this.state.valid && <div className=\"image_main_wrapper\">\n                <div\n                    className={`image_wrapper ${animation} ${magnify}`}\n                    onMouseLeave={(e) => this.mouseLeave(e)}\n                    onMouseEnter={(e) => this.mouseEnter(e)}\n                    onClick={(e) => this.click(e)}\n                >\n                    {loading\n                        ? <Loader type=\"ball-scale-multiple\" className=\"image_loader\"/>\n                        : isVideo(main.src)\n                            ? <video height={styles.picture_height}\n                                     width={styles.picture_width}\n                                     className=\"video\">\n                                <source src={main.src}/>\n                            </video>\n                            : <img className='image'\n                                   src={main.src}\n                                   alt=\"something wrong happens\"/>}\n                    <div className={'overlay'}>\n                        <div className={`overlay_top`}>\n                            <MagnifierIcon/>\n                        </div>\n                        <div className={`overlay_bottom`}>\n                            <div className='overlay_bottom_text'>{album.name}</div>\n                        </div>\n                    </div>\n                </div>\n                {magnify && [<div key=\"preview_overlay\" className=\"preview_overlay\"/>,\n                <Preview main={main}\n                         key=\"preview\"\n                         close={() => this.closePreview()}\n                         editRoute={`/edit/${album._id}`}\n                         images={album.images}/>]}\n            </div>;\n    }\n}\n\nexport default Picture;\n\n\n\n\n// WEBPACK FOOTER //\n// ./components/picture/Picture.jsx"],"sourceRoot":""}